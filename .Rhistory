n_iter <- ceiling(epochs_per_iter * (NROW(x)/batch_size))
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i < 28000){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 - cos(lr_to_current / (lr_t_i - 1) * pi)))
} else if(i  >= 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation
+ 1/2 * (lr_min - lr_annihilation)
* (1 + cos((lr_to_current) / (lr_t_i - 1) * pi)))
}
}
x2 <- 1:60000
plot(x2, new_lr)
lr_annihilation <- 0.00000015
lr_min <- 0.0000015
lr_max <- 0.000015
lr_t_O <- 28000
lr_t_i <- lr_t_O
epochs_per_iter <- 100
x <- c(1:240000)
batch_size <- 400
n_iter <- ceiling(epochs_per_iter * (NROW(x)/batch_size))
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i < 28000){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 - cos(lr_to_current / (lr_t_i - 1) * pi)))
} else if(i  >= 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation
+ 1/2 * (lr_min - lr_annihilation)
* (1 + cos((lr_to_current) / (lr_t_i - 1) * pi)))
}
}
x2 <- 1:60000
plot(x2, new_lr)
lr_annihilation <- 0.00000015
lr_min <- 0.0000015
lr_max <- 0.000015
lr_t_O <- 28000
lr_t_i <- lr_t_O
epochs_per_iter <- 100
x <- c(1:240000)
batch_size <- 400
n_iter <- ceiling(epochs_per_iter * (NROW(x)/batch_size))
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i < 28000){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 - cos(lr_to_current / (lr_t_i - 1) * pi)))
} else if(i  >= 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation
+ 1/2 * (lr_min - lr_annihilation)
* (1 + cos((lr_to_current) / ((lr_t_i- 56000) - 1) * pi)))
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- ((lr_max - lr_min)/(28000 - lr_to_current))
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation
+ 1/2 * (lr_min - lr_annihilation)
* (1 + cos((lr_to_current) / ((lr_t_i- 56000) - 1) * pi)))
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- -1 * ((lr_min - lr_max)/(28000 - lr_to_current))
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation
+ 1/2 * (lr_min - lr_annihilation)
* (1 + cos((lr_to_current) / ((lr_t_i- 56000) - 1) * pi)))
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- ((lr_min - lr_max)/(28000 - lr_to_current))
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation
+ 1/2 * (lr_min - lr_annihilation)
* (1 + cos((lr_to_current) / ((lr_t_i- 56000) - 1) * pi)))
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation
+ 1/2 * (lr_min - lr_annihilation)
* (1 + cos((lr_to_current) / ((lr_t_i- 56000) - 1) * pi)))
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - 1/100 * i)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current))
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation - ((lr_annihilation - lr_min)/(60000 - (2*28000))) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation - ((lr_annihilation + lr_min)/(60000 - (2*28000))) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation - ((lr_annihilation + lr_min)/1000) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - (1/100) * lr_to_current))
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - (1/100) * lr_to_current))
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - (1/100) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation - ((lr_min - lr_annihilation)/4000) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation - ((lr_min + lr_annihilation)/4000) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_annihilation - ((lr_min + lr_annihilation))/lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (-(lr_min + lr_annihilation)/4000) * lr_to_current + lr_annihilation)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (-1*(lr_min + lr_annihilation)/4000) * lr_to_current + lr_annihilation)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - ((lr_max - lr_min)/28000) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - ((lr_min - lr_annihilation)/4000) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min + ((lr_min - lr_annihilation)/4000) * lr_to_current)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min + ((lr_annihilation - lr_min)/4000) * lr_to_current - 56000)
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min + ((lr_annihilation - lr_min)/4000) * (lr_to_current - 56000))
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - ((lr_annihilation - lr_min)/4000) * (lr_to_current - 56000))
}
}
x2 <- 1:60000
plot(x2, new_lr)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - ((lr_annihilation + lr_min)/4000) * (lr_to_current - 56000))
}
}
x2 <- 1:60000
plot(x2, new_lr)
plot(x2, new_lr, cex = 0.2)
library(ggplot2)
ggplot()+
geom_line(aes(x = new_lr, y = x2))
x <- unlist(new_lr)
ggplot()+
geom_line(aes(x = x, y = x2))
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/(28000 - lr_to_current)) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - ((lr_annihilation + lr_min)/4000) * (lr_to_current - 56000))
}
}
x2 <- 1:60000
plot(x2, new_lr, cex = 0.2)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_min - lr_max)/(28000 - lr_to_current)) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - ((lr_annihilation + lr_min)/4000) * (lr_to_current - 56000))
}
}
x2 <- 1:60000
plot(x2, new_lr, cex = 0.2)
new_lr <- list()
for(i in 1:(n_iter)){
lr_to_current <- i
if(i <= 28000){
new_lr[[i]] <- (lr_min + ((lr_max - lr_min)/28000) * lr_to_current)
} else if(i  > 28000 && i  < 56001 ){
new_lr[[i]] <- (lr_min
+ 1/2 * (lr_max - lr_min)
* (1 + cos((lr_to_current - 28000) / (lr_t_i - 1) * pi)))
} else if(i >= 56001){
new_lr[[i]] <- (lr_min - ((lr_annihilation + lr_min)/4000) * (lr_to_current - 56000))
}
}
x2 <- 1:60000
plot(x2, new_lr, cex = 0.2)
plot
library(ggplot2)
x <- unlist(new_lr)
ggplot()+
geom_line(aes(x = x, y = x2))
new_lr[[1]]
new_lr[[2]]
ggplot()+
geom_line(aes(x = x, y = x2))
ggplot()+
geom_line(aes(x = x2, y = x))
library(plotly)
ggploty(p)
ploty(p)
plotly(p)
p <- ggplot()+
geom_line(aes(x = x2, y = x))
plotly(p)
ggplotly(p)
plot(x2, new_lr, cex = 0.2)
ggplotly(p)
ploty(p)
plotly(p)
ggplotly(p)
knitr::opts_chunk$set(echo = TRUE)
x <- matrix(rnorm(32), nrow = 6)
y <- c(rnorm(6))
x <- c(rnorm(6))
library(pracma)
meshgrid(x,y)
xx, yy <- meshgrid(x,y)
list =  meshgrid(x,y)
f <- function(x, y) { r <- sqrt(x %*% x + y %*% y); 10 * sin(r)/r }
z <- outer(list[[1]], list[[2]], f)
f <- function(x, y) { r <- x %*% x + y %*% y}
z <- outer(list[[1]], list[[2]], f)
list[[1]]
list[[1]] %*% list[[1]]
z <- list[[1]] %*% list[[1]] + list[[2]] + list[[2]]
library(rgl)
surface3d(x, y, z)
setwd("D:/DataScience_Folder/CSAFE/this-is-us")
