<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Shoes | This is us: making CSAFE stronger each week</title>
  <meta name="description" content="This is our new approach of showing our progress one week at a time. This book is based on the minimal example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Shoes | This is us: making CSAFE stronger each week" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is our new approach of showing our progress one week at a time. This book is based on the minimal example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="csafe-isu/this-is-us" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Shoes | This is us: making CSAFE stronger each week" />
  
  <meta name="twitter:description" content="This is our new approach of showing our progress one week at a time. This book is based on the minimal example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="CSAFE" />


<meta name="date" content="2021-03-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glass.html"/>
<link rel="next" href="theoretical-foundations.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">This is us</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#setting-up-the-repository"><i class="fa fa-check"></i><b>1.1</b> Setting up the repository</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#contributions-to-the-repository"><i class="fa fa-check"></i><b>1.2</b> Contributions to the repository</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#guidelines-for-show-and-tell"><i class="fa fa-check"></i><b>2.1</b> Guidelines for show and tell</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#rmarkdown-how-to"><i class="fa fa-check"></i><b>2.2</b> Rmarkdown how-to</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dummy-file.html"><a href="dummy-file.html"><i class="fa fa-check"></i><b>3</b> Dummy file</a></li>
<li class="chapter" data-level="4" data-path="bullets.html"><a href="bullets.html"><i class="fa fa-check"></i><b>4</b> Project CC: Bullets and Cartridge Cases</a><ul>
<li class="chapter" data-level="4.1" data-path="bullets.html"><a href="bullets.html#data-collection"><i class="fa fa-check"></i><b>4.1</b> Data Collection</a><ul>
<li class="chapter" data-level="4.1.1" data-path="bullets.html"><a href="bullets.html#breech-face-images"><i class="fa fa-check"></i><b>4.1.1</b> Breech face images</a></li>
<li class="chapter" data-level="4.1.2" data-path="bullets.html"><a href="bullets.html#scans-from-land-engraved-areas-on-fired-bullets"><i class="fa fa-check"></i><b>4.1.2</b> Scans from land engraved areas on fired bullets</a></li>
<li class="chapter" data-level="4.1.3" data-path="bullets.html"><a href="bullets.html#lapd"><i class="fa fa-check"></i><b>4.1.3</b> LAPD</a></li>
<li class="chapter" data-level="4.1.4" data-path="bullets.html"><a href="bullets.html#hamby-sets"><i class="fa fa-check"></i><b>4.1.4</b> Hamby Sets</a></li>
<li class="chapter" data-level="4.1.5" data-path="bullets.html"><a href="bullets.html#houston-tests"><i class="fa fa-check"></i><b>4.1.5</b> Houston Tests</a></li>
<li class="chapter" data-level="4.1.6" data-path="bullets.html"><a href="bullets.html#houston-persistence"><i class="fa fa-check"></i><b>4.1.6</b> Houston Persistence</a></li>
<li class="chapter" data-level="4.1.7" data-path="bullets.html"><a href="bullets.html#st-louis-persistence"><i class="fa fa-check"></i><b>4.1.7</b> St Louis persistence</a></li>
<li class="chapter" data-level="4.1.8" data-path="bullets.html"><a href="bullets.html#dfsc-cartridge-cases"><i class="fa fa-check"></i><b>4.1.8</b> DFSC Cartridge cases</a></li>
<li class="chapter" data-level="4.1.9" data-path="bullets.html"><a href="bullets.html#rotation-stage"><i class="fa fa-check"></i><b>4.1.9</b> Rotation stage</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bullets.html"><a href="bullets.html#computational-tools"><i class="fa fa-check"></i><b>4.2</b> Computational Tools</a><ul>
<li class="chapter" data-level="4.2.1" data-path="bullets.html"><a href="bullets.html#x3ptools"><i class="fa fa-check"></i><b>4.2.1</b> x3ptools</a></li>
<li class="chapter" data-level="4.2.2" data-path="bullets.html"><a href="bullets.html#bulletxtrctr"><i class="fa fa-check"></i><b>4.2.2</b> bulletxtrctr</a></li>
<li class="chapter" data-level="4.2.3" data-path="bullets.html"><a href="bullets.html#groovefinder"><i class="fa fa-check"></i><b>4.2.3</b> grooveFinder</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="bullets.html"><a href="bullets.html#similarity-scores"><i class="fa fa-check"></i><b>4.3</b> Similarity Scores</a><ul>
<li class="chapter" data-level="4.3.1" data-path="bullets.html"><a href="bullets.html#bullet-lands"><i class="fa fa-check"></i><b>4.3.1</b> Bullet Lands</a></li>
<li class="chapter" data-level="4.3.2" data-path="bullets.html"><a href="bullets.html#cartridge-cases"><i class="fa fa-check"></i><b>4.3.2</b> Cartridge Cases</a></li>
<li class="chapter" data-level="4.3.3" data-path="bullets.html"><a href="bullets.html#modified-chumbley-non-random-test"><i class="fa fa-check"></i><b>4.3.3</b> Modified Chumbley non-random test</a></li>
<li class="chapter" data-level="4.3.4" data-path="bullets.html"><a href="bullets.html#cmps-algorithm"><i class="fa fa-check"></i><b>4.3.4</b> CMPS Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bullets.html"><a href="bullets.html#assessing-quality-of-scans"><i class="fa fa-check"></i><b>4.4</b> Assessing Quality of Scans</a><ul>
<li class="chapter" data-level="4.4.1" data-path="bullets.html"><a href="bullets.html#current-data-processing-procedures"><i class="fa fa-check"></i><b>4.4.1</b> Current Data Processing Procedures</a></li>
<li class="chapter" data-level="4.4.2" data-path="bullets.html"><a href="bullets.html#convolutional-neural-networks"><i class="fa fa-check"></i><b>4.4.2</b> Convolutional Neural Networks</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="bullets.html"><a href="bullets.html#analysis-of-results"><i class="fa fa-check"></i><b>4.5</b> Analysis of Results</a><ul>
<li class="chapter" data-level="4.5.1" data-path="bullets.html"><a href="bullets.html#stability-of-the-analysis-process"><i class="fa fa-check"></i><b>4.5.1</b> Stability of the Analysis Process</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="bullets.html"><a href="bullets.html#communication-of-results-and-methods"><i class="fa fa-check"></i><b>4.6</b> Communication of Results and Methods</a></li>
<li class="chapter" data-level="4.7" data-path="bullets.html"><a href="bullets.html#explainable-results-usability-and-trust-survey"><i class="fa fa-check"></i><b>4.7</b> Explainable results: Usability and Trust survey</a><ul>
<li class="chapter" data-level="4.7.1" data-path="bullets.html"><a href="bullets.html#measuring-trust-and-calibration"><i class="fa fa-check"></i><b>4.7.1</b> Measuring Trust and calibration</a></li>
<li class="chapter" data-level="4.7.2" data-path="bullets.html"><a href="bullets.html#survey-methods-pre--vs-post"><i class="fa fa-check"></i><b>4.7.2</b> Survey Methods : Pre- vs Post</a></li>
<li class="chapter" data-level="4.7.3" data-path="bullets.html"><a href="bullets.html#conference-presentations"><i class="fa fa-check"></i><b>4.7.3</b> Conference Presentations</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="bullets.html"><a href="bullets.html#people-involved"><i class="fa fa-check"></i><b>4.8</b> People involved</a><ul>
<li class="chapter" data-level="4.8.1" data-path="bullets.html"><a href="bullets.html#faculty"><i class="fa fa-check"></i><b>4.8.1</b> Faculty</a></li>
<li class="chapter" data-level="4.8.2" data-path="bullets.html"><a href="bullets.html#graduate-students"><i class="fa fa-check"></i><b>4.8.2</b> Graduate Students</a></li>
<li class="chapter" data-level="4.8.3" data-path="bullets.html"><a href="bullets.html#undergraduates"><i class="fa fa-check"></i><b>4.8.3</b> Undergraduates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html"><i class="fa fa-check"></i><b>5</b> Project G: Handwriting (&amp; Signatures)</a><ul>
<li class="chapter" data-level="5.1" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#data-collection-1"><i class="fa fa-check"></i><b>5.1</b> Data Collection</a></li>
<li class="chapter" data-level="5.2" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#computational-tools-1"><i class="fa fa-check"></i><b>5.2</b> Computational Tools</a><ul>
<li class="chapter" data-level="5.2.1" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#graph-measurements-extracted-in-rcpp-by-james"><i class="fa fa-check"></i><b>5.2.1</b> Graph measurements (extracted in RCpp by James)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#statistical-analysis"><i class="fa fa-check"></i><b>5.3</b> Statistical Analysis</a><ul>
<li class="chapter" data-level="5.3.1" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#clustering"><i class="fa fa-check"></i><b>5.3.1</b> Clustering</a></li>
<li class="chapter" data-level="5.3.2" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#statistical-modeling"><i class="fa fa-check"></i><b>5.3.2</b> Statistical Modeling</a></li>
<li class="chapter" data-level="5.3.3" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#interesting-documents"><i class="fa fa-check"></i><b>5.3.3</b> Interesting documents</a></li>
<li class="chapter" data-level="5.3.4" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#alis-project"><i class="fa fa-check"></i><b>5.3.4</b> Ali’s project</a></li>
<li class="chapter" data-level="5.3.5" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#open-set-modeling-for-writer-identification-from-distribution-of-glyphs-in-clusters"><i class="fa fa-check"></i><b>5.3.5</b> Open Set Modeling for Writer Identification from Distribution of Glyphs in Clusters</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#communication-of-results"><i class="fa fa-check"></i><b>5.4</b> Communication of Results</a><ul>
<li class="chapter" data-level="5.4.1" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#papers"><i class="fa fa-check"></i><b>5.4.1</b> Papers</a></li>
<li class="chapter" data-level="5.4.2" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#talks"><i class="fa fa-check"></i><b>5.4.2</b> Talks</a></li>
<li class="chapter" data-level="5.4.3" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#posters"><i class="fa fa-check"></i><b>5.4.3</b> Posters</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#people-involved-1"><i class="fa fa-check"></i><b>5.5</b> People involved</a><ul>
<li class="chapter" data-level="5.5.1" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#faculty-1"><i class="fa fa-check"></i><b>5.5.1</b> Faculty</a></li>
<li class="chapter" data-level="5.5.2" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#graduate-students-1"><i class="fa fa-check"></i><b>5.5.2</b> Graduate Students</a></li>
<li class="chapter" data-level="5.5.3" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#undergraduates-1"><i class="fa fa-check"></i><b>5.5.3</b> Undergraduates</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="project-g-handwriting-signatures.html"><a href="project-g-handwriting-signatures.html#deep-learning-methods"><i class="fa fa-check"></i><b>5.6</b> Deep Learning Methods</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glass.html"><a href="glass.html"><i class="fa fa-check"></i><b>6</b> Glass</a><ul>
<li class="chapter" data-level="6.1" data-path="glass.html"><a href="glass.html#data-collection-2"><i class="fa fa-check"></i><b>6.1</b> Data collection</a></li>
<li class="chapter" data-level="6.2" data-path="glass.html"><a href="glass.html#data-collection-2.0"><i class="fa fa-check"></i><b>6.2</b> Data collection 2.0</a></li>
<li class="chapter" data-level="6.3" data-path="glass.html"><a href="glass.html#the-astm-standard-method"><i class="fa fa-check"></i><b>6.3</b> The ASTM standard method</a></li>
<li class="chapter" data-level="6.4" data-path="glass.html"><a href="glass.html#learning-algorithms-to-evaluate-forensic-glass-evidence"><i class="fa fa-check"></i><b>6.4</b> Learning algorithms to evaluate forensic glass evidence</a></li>
<li class="chapter" data-level="6.5" data-path="glass.html"><a href="glass.html#evaluation-and-comparison-of-methods-for-forensic-glass-source-conclusions"><i class="fa fa-check"></i><b>6.5</b> Evaluation and comparison of methods for forensic glass source conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="shoes.html"><a href="shoes.html"><i class="fa fa-check"></i><b>7</b> Shoes</a><ul>
<li class="chapter" data-level="7.1" data-path="shoes.html"><a href="shoes.html#longitudinal"><i class="fa fa-check"></i><b>7.1</b> Longitudinal Shoe Study</a><ul>
<li class="chapter" data-level="7.1.1" data-path="shoes.html"><a href="shoes.html#paper-describing-the-database"><i class="fa fa-check"></i><b>7.1.1</b> Paper describing the database</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="shoes.html"><a href="shoes.html#shoescanner"><i class="fa fa-check"></i><b>7.2</b> Shoe Scanner - Passive Shoe Recognition</a><ul>
<li class="chapter" data-level="7.2.1" data-path="shoes.html"><a href="shoes.html#nij-grant"><i class="fa fa-check"></i><b>7.2.1</b> NIJ Grant</a></li>
<li class="chapter" data-level="7.2.2" data-path="shoes.html"><a href="shoes.html#connor-convolutional-neural-network-for-outsole-recognition"><i class="fa fa-check"></i><b>7.2.2</b> CoNNOR: Convolutional Neural Network for Outsole Recognition</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="shoes.html"><a href="shoes.html#maxclique"><i class="fa fa-check"></i><b>7.3</b> Maximum Clique Matching</a></li>
<li class="chapter" data-level="7.4" data-path="shoes.html"><a href="shoes.html#cocoa"><i class="fa fa-check"></i><b>7.4</b> Project Tread (formerly Cocoa Powder Citizen Science)</a></li>
<li class="chapter" data-level="7.5" data-path="shoes.html"><a href="shoes.html#d-shoe-recognition"><i class="fa fa-check"></i><b>7.5</b> 3d Shoe Recognition</a></li>
<li class="chapter" data-level="7.6" data-path="shoes.html"><a href="shoes.html#shoe-outsole-matching-using-image-descriptors"><i class="fa fa-check"></i><b>7.6</b> Shoe outsole matching using image descriptors</a><ul>
<li class="chapter" data-level="7.6.1" data-path="shoes.html"><a href="shoes.html#method-1-edge-detection-and-mc-mc-comp"><i class="fa fa-check"></i><b>7.6.1</b> Method 1: Edge detection and MC (MC-COMP)</a></li>
<li class="chapter" data-level="7.6.2" data-path="shoes.html"><a href="shoes.html#method-2-surf-detection-and-mc-on-degraded-impressions"><i class="fa fa-check"></i><b>7.6.2</b> Method 2: SURF detection and MC on degraded impressions</a></li>
<li class="chapter" data-level="7.6.3" data-path="shoes.html"><a href="shoes.html#research-1-features"><i class="fa fa-check"></i><b>7.6.3</b> Research 1: Features</a></li>
<li class="chapter" data-level="7.6.4" data-path="shoes.html"><a href="shoes.html#matching-on-clean-and-full-images-with-several-features"><i class="fa fa-check"></i><b>7.6.4</b> Matching on clean and full images with several features</a></li>
<li class="chapter" data-level="7.6.5" data-path="shoes.html"><a href="shoes.html#matching-on-degraded-and-partial-images"><i class="fa fa-check"></i><b>7.6.5</b> Matching on degraded and partial images</a></li>
<li class="chapter" data-level="7.6.6" data-path="shoes.html"><a href="shoes.html#research-2-impact-of-weight-to-outsole-scans-from-everos-2d-scanner"><i class="fa fa-check"></i><b>7.6.6</b> Research 2: Impact of weight to outsole scans from EverOS 2D scanner</a></li>
<li class="chapter" data-level="7.6.7" data-path="shoes.html"><a href="shoes.html#research-3-mc-cnn"><i class="fa fa-check"></i><b>7.6.7</b> Research 3: MC + CNN</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="shoes.html"><a href="shoes.html#matching-shoe-prints-with-ccf"><i class="fa fa-check"></i><b>7.7</b> Matching shoe prints with ccf</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html"><i class="fa fa-check"></i><b>8</b> Theoretical foundations</a><ul>
<li class="chapter" data-level="8.1" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#explaining-slr-behavior"><i class="fa fa-check"></i><b>8.1</b> Explaining SLR behavior</a></li>
<li class="chapter" data-level="8.2" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#common-source-vs-specific-source-comparison-via-information-theory"><i class="fa fa-check"></i><b>8.2</b> Common Source vs Specific Source Comparison via Information Theory</a><ul>
<li class="chapter" data-level="8.2.1" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#introduction"><i class="fa fa-check"></i><b>8.2.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2.2" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#common-source-vs-specific-source-lr"><i class="fa fa-check"></i><b>8.2.2</b> Common Source vs Specific Source LR</a></li>
<li class="chapter" data-level="8.2.3" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#other-notions-of-information"><i class="fa fa-check"></i><b>8.2.3</b> Other notions of information</a></li>
<li class="chapter" data-level="8.2.4" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#information-theoretic-specific-source-score-sufficiency-metric"><i class="fa fa-check"></i><b>8.2.4</b> Information Theoretic Specific Source Score Sufficiency Metric</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#score-based-likelihood-ratios-are-not-fundamentally-incoherent"><i class="fa fa-check"></i><b>8.3</b> Score-based Likelihood Ratios are not Fundamentally “Incoherent”</a><ul>
<li class="chapter" data-level="8.3.1" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#coherence"><i class="fa fa-check"></i><b>8.3.1</b> Coherence</a></li>
<li class="chapter" data-level="8.3.2" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#problems-with-arguments-showing-slrs-are-incoherent"><i class="fa fa-check"></i><b>8.3.2</b> Problems with arguments showing SLRs are incoherent</a></li>
<li class="chapter" data-level="8.3.3" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#example-of-a-coherent-slr-in-the-two-source-problem"><i class="fa fa-check"></i><b>8.3.3</b> Example of a coherent SLR in the two source problem</a></li>
<li class="chapter" data-level="8.3.4" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#possible-generalizations-of-coherent-slrs-to-the-multisource-case"><i class="fa fa-check"></i><b>8.3.4</b> Possible Generalizations of Coherent SLRs to the Multisource Case</a></li>
<li class="chapter" data-level="8.3.5" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#multisource-example"><i class="fa fa-check"></i><b>8.3.5</b> Multisource example</a></li>
<li class="chapter" data-level="8.3.6" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#other-possible-viewpoints"><i class="fa fa-check"></i><b>8.3.6</b> Other Possible Viewpoints?</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#copper-wire-synthetic-data"><i class="fa fa-check"></i><b>8.4</b> Copper Wire Synthetic Data</a></li>
<li class="chapter" data-level="8.5" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#optimal-matching-problem"><i class="fa fa-check"></i><b>8.5</b> Optimal matching problem</a><ul>
<li class="chapter" data-level="8.5.1" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#two-groups-case."><i class="fa fa-check"></i><b>8.5.1</b> Two groups case.</a></li>
<li class="chapter" data-level="8.5.2" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#topics-needs-exploration"><i class="fa fa-check"></i><b>8.5.2</b> Topics needs exploration</a></li>
<li class="chapter" data-level="8.5.3" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#brief-introduction-to-optimal-rule"><i class="fa fa-check"></i><b>8.5.3</b> Brief introduction to optimal rule</a></li>
<li class="chapter" data-level="8.5.4" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#optimal-rule-for-matching-problems"><i class="fa fa-check"></i><b>8.5.4</b> Optimal rule for matching problems</a></li>
<li class="chapter" data-level="8.5.5" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#simulation-plan"><i class="fa fa-check"></i><b>8.5.5</b> Simulation plan</a></li>
<li class="chapter" data-level="8.5.6" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#simulation-results"><i class="fa fa-check"></i><b>8.5.6</b> Simulation results</a></li>
<li class="chapter" data-level="8.5.7" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#real-data-for-simulations"><i class="fa fa-check"></i><b>8.5.7</b> Real data for simulations</a></li>
<li class="chapter" data-level="8.5.8" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#simulation-results-using-glass-data"><i class="fa fa-check"></i><b>8.5.8</b> Simulation results using glass data</a></li>
<li class="chapter" data-level="8.5.9" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#extension-to-openset-problems"><i class="fa fa-check"></i><b>8.5.9</b> Extension to openset problems</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#srl-behaviour-and-dependence"><i class="fa fa-check"></i><b>8.6</b> SRL behaviour and dependence</a><ul>
<li class="chapter" data-level="8.6.1" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#introduction."><i class="fa fa-check"></i><b>8.6.1</b> Introduction.</a></li>
<li class="chapter" data-level="8.6.2" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#a-pipeline-for-testing-forensic-algorithm."><i class="fa fa-check"></i><b>8.6.2</b> A pipeline for testing forensic algorithm.</a></li>
<li class="chapter" data-level="8.6.3" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#simulating-realistic-data."><i class="fa fa-check"></i><b>8.6.3</b> Simulating realistic data.</a></li>
<li class="chapter" data-level="8.6.4" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#forensic-set-up"><i class="fa fa-check"></i><b>8.6.4</b> Forensic set up</a></li>
<li class="chapter" data-level="8.6.5" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#model-set-up"><i class="fa fa-check"></i><b>8.6.5</b> Model set up</a></li>
<li class="chapter" data-level="8.6.6" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#simulation-basics."><i class="fa fa-check"></i><b>8.6.6</b> Simulation basics.</a></li>
<li class="chapter" data-level="8.6.7" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#slr."><i class="fa fa-check"></i><b>8.6.7</b> SLR.</a></li>
<li class="chapter" data-level="8.6.8" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#lr"><i class="fa fa-check"></i><b>8.6.8</b> LR</a></li>
<li class="chapter" data-level="8.6.9" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#train--test---validation."><i class="fa fa-check"></i><b>8.6.9</b> Train- Test - Validation.</a></li>
<li class="chapter" data-level="8.6.10" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#metrics-for-comparing-results"><i class="fa fa-check"></i><b>8.6.10</b> Metrics for comparing results</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#evaluation-metrics."><i class="fa fa-check"></i><b>8.7</b> Evaluation metrics.</a><ul>
<li class="chapter" data-level="8.7.1" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#results"><i class="fa fa-check"></i><b>8.7.1</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#srl-behaviour-and-dependence-extended-simulation."><i class="fa fa-check"></i><b>8.8</b> SRL behaviour and dependence: Extended simulation.</a></li>
<li class="chapter" data-level="8.9" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#communication-of-results-1"><i class="fa fa-check"></i><b>8.9</b> Communication of Results</a><ul>
<li class="chapter" data-level="8.9.1" data-path="theoretical-foundations.html"><a href="theoretical-foundations.html#poster"><i class="fa fa-check"></i><b>8.9.1</b> Poster</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="outreach-activities.html"><a href="outreach-activities.html"><i class="fa fa-check"></i><b>9</b> Outreach activities</a><ul>
<li class="chapter" data-level="9.1" data-path="outreach-activities.html"><a href="outreach-activities.html#book-on-forensic-science-and-statistics"><i class="fa fa-check"></i><b>9.1</b> Book on Forensic Science and Statistics</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reproducibility-in-research.html"><a href="reproducibility-in-research.html"><i class="fa fa-check"></i><b>10</b> Reproducibility in Research</a><ul>
<li class="chapter" data-level="10.1" data-path="reproducibility-in-research.html"><a href="reproducibility-in-research.html#computational-reproducibility"><i class="fa fa-check"></i><b>10.1</b> Computational Reproducibility</a><ul>
<li class="chapter" data-level="10.1.1" data-path="reproducibility-in-research.html"><a href="reproducibility-in-research.html#computational-reproducibility-in-team-based-collaboration"><i class="fa fa-check"></i><b>10.1.1</b> Computational Reproducibility in Team-based Collaboration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">This is us: making CSAFE stronger each week</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="shoes" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Shoes</h1>
<div id="longitudinal" class="section level2">
<h2><span class="header-section-number">7.1</span> Longitudinal Shoe Study</h2>
<p><a href="https://github.com/CSAFE-ISU/Longitudinal_Shoe_Study">Github repository</a></p>
<div id="paper-describing-the-database" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Paper describing the database</h3>
<p><a href="https://github.com/CSAFE-ISU/Longitudinal_Shoe_Study/tree/master/Paper">Paper subdirectory of Github repository</a></p>
<p>Goal:</p>
<ul>
<li>Describe experiment</li>
<li>Describe database function</li>
<li>Publicize data for analysis by others in the community</li>
</ul>
<p>Accompanied by Figshare upload of static data sets (grouped by type).</p>
<div id="lss-paper-analysis" class="section level4 unnumbered">
<h4>Data Analysis Tools</h4>
<ul>
<li>Working with the <code>EBImage</code> package - very fast processing of images</li>
</ul>
<div id="lss-data-cleaning" class="section level5 unnumbered">
<h5><code>ShoeScrubR</code> package</h5>
<p>Cleaning methods for the Longitudinal data are contained in the <a href="https://github.com/srvanderplas/ShoeScrubR"><code>ShoeScrubR</code> package</a>. The package includes (as of 2019-10-17) a complete set of tests to guard against regressions (100% test coverage!) and uses continuous integration to ensure that the installation process is also monitored.</p>
<p>The <code>ShoeScrubR</code> package also includes logging of all image-in image-out operations using attributes - each time a transformation is performed, the transformation and the parameters are appended to the running operations log. This should make it possible to track the provenance of an object through the set of transformations (and potentially un-do them in some cases).</p>
</div>
<div id="lss-paper-analysis-film" class="section level5 unnumbered">
<h5>Film and Powder Images</h5>
<p>The images are challenging to do basic statistical analysis on because the shoe print is made up of tiny particles (e.g. it is not a solid object), and there are areas of smudged particles outside the image (fingerprints, etc.) that can be hard to automatically remove. In addition, the film backing has subtle variations in color.</p>
<p>The prints are not rotationally aligned, that is, they are taken at a variety of angles (usually <span class="math inline">\(\pm 15^\circ\)</span> from vertical) which vary due to individual differences in walking style, the orientation of the film, and changes in experimental protocol.</p>
<p>Experimental protocol changes included resolution changes for the scans over time: the resolution of the last set of images is about 2 times higher than the resolution of the first 3 check-ins worth of images. Thus, parameters need to be automatically selected based on the resolution of the image.</p>
<p>The initial use of templates to clean up the image requires addressing the alignment of the print and the template. As this experiment contains 8 total shoe model and size combinations, it is possible to create a template for each shoe model and use that template to isolate the region of the image which contains a set of features most likely to be a shoe (rather than random noise).</p>
<p>Solving the template problem by aligning the mask and template yields an additional benefit: the resulting cleaned up image is roughly aligned relative to the template and, presumably, to other images.</p>
<details>
<p><summary>Rough Alignment of Template Mask and Image: Clean images, do a rough alignment between the image and the corresponding shoe mask (per model and size). </summary></p>
<ol style="list-style-type: decimal">
<li><p>Rotationally align image and mask using principal components on the non-background pixels in the image</p></li>
<li><p>Gross align the non-background pixels in the image and mask</p>
<ul>
<li><p>Use a “mask-ified” version of the shoe print that encloses most of the shoe region in a single region (see below for explanation)</p></li>
<li><p>Default to trimming the actual print by 5% on each dimension to minimize the effect of page borders and creases</p></li>
<li><p>Alignment method options:</p>
<ul>
<li>center of mass - this fails if a print does not account for the whole shoe</li>
<li>center of narrowest width - ideally, this is approximately the arch of the shoe.<br />
This works better than center of mass in most cases, but occasionally computation fails because it relies on finding a local minimum near the center of the image; if the derivative calculation fails, the algorithm falls back to the center of narrowest width.</li>
</ul></li>
</ul></li>
<li><p>Pad the image and mask so that the centers are aligned and the image and mask are the same size</p></li>
<li><p>Set any pixels outside the mask to background</p></li>
</ol>
<p>Before:<br />
<img src="images/shoes/longitudinal/PCA_Rotate_and_Center_Shift_Before.png" width = "100%"/></p>
<p>After:<br />
<img src="images/shoes/longitudinal/PCA_Rotate_and_Center_Shift_After.png" width = "100%"/></p>
These steps are wrapped into the <code>rough_align</code> function in the <code>ShoeScrubR</code> package.
</details>
<details>
<p><summary>Cleaning the image and exaggerating into a mask</summary>
In several of the methods applied to this data, it has been useful to have an exaggerated version of the image to function as a mask - this exaggerated image has a center of mass similar to the actual mask, for instance.</p>
<p>Creating this mask requires parameter tuning (done the old way); a new method was developed in order to reduce the number of parameters which depended on image resolution and other similar items.</p>
<p>In the old method, there were several parameters necessary - gaussian blur diameter for image cleaning, threshold for binarization, gaussian blur diameter for mask creation, threshold for image cleaning, diameter for opening the mask, diameter for closing the mask.</p>
<p>The new steps are as follows:</p>
<ol style="list-style-type: decimal">
<li>Use the EM algorithm to cluster the intensities of the points into three normally distributed categories: signal, intermediate, and background. The normality assumption is highly questionable, but the method works pretty well. Use the calculated pdf values for each point to construct a likelihood ratio of P(signal)/P(intermediate + background). Binarize based on the value of this likelihood ratio - if it’s over 10, the pixel is signal.
<ul>
<li>Each shoe is shown in three separate images, corresponding to the pdf value for each point based on the EM algorithm clustering distribution fitted values. White pixels are highly likely to belong to the group in question - signal, intermediate, and noise.<br />
<img src="images/shoes/longitudinal/EM_pixsets.png" width = "80%"/><br />
</li>
<li>Binarized versions of each shoe<br />
<img src="images/shoes/longitudinal/EM_LR10_pixset.png" width = "100%"/></li>
</ul></li>
<li>The binarized image from the EM algorithm is cleaned slightly using parameters that should be robust to different ppi images (diameters &lt; 10 pixels) - this gets rid of speckling induced by the EM segmentation.
<ul>
<li>Initial cleaning - dilation and erosion at very small pixel values<br />
<img src="images/shoes/longitudinal/EM_LR10_clean.png" width = "100%"/></li>
<li>Labeling disjoint regions (different colors indicate different regions)
<img src="images/shoes/longitudinal/EM_LR10_label.png" width = "100%"/></li>
<li>Removing any blobs which are in the 50px square corner region and which do not involve more than 10% of the image.<br />
<img src="images/shoes/longitudinal/EM_LR10_corner_clean.png" width = "100%"/><br />
At this point we can use the mask to clean the image:<br />
<img src="images/shoes/longitudinal/EM_LR10_clean_img.png" width = "100%"/></li>
</ul></li>
<li>The binarized image is exaggerated using parameters which depend only on the size of the image. In general, size <span class="math inline">\(s\)</span> here is the square root of the number of pixels in the image, that is, the side length of the image if it were square.
<ul>
<li>A gaussian blur is applied to the image (diameter <span class="math inline">\(s\)</span>/50)<br />
<img src="images/shoes/longitudinal/EM_LR10_blur_img.png" width = "100%"/></li>
<li>Any pixel intensity less than the median is determined to be shoe<br />
<img src="images/shoes/longitudinal/EM_LR10_blur_thresh.png" width = "100%"/></li>
<li>All disjoint regions are labeled<br />
<img src="images/shoes/longitudinal/EM_LR10_blur_label.png" width = "100%"/></li>
<li>The largest region is selected as the best mask for the shoe
<img src="images/shoes/longitudinal/EM_LR10_exag_mask.png" width = "100%"/></li>
<li>Some cleaning is done to this mask - any holes are filled in and then it is opened by a diameter of approximately <span class="math inline">\(s\)</span>/5 (must be odd)<br />
<img src="images/shoes/longitudinal/EM_LR10_mask_final.png" width = "100%"/></li>
</ul></li>
</ol>
<p>At this point we can use the mask to get a “clean” image:<br />
<img src="images/shoes/longitudinal/EM_LR10_image_mask_final.png" width = "100%"/></p>
<p>And proceed with the alignment as normal:</p>
<img src="images/shoes/longitudinal/EM_LR10_alignment.png" width = "100%"/>
</details>
Aligning each image to the template corresponding to the shoe model and size provides a good first step towards aligning the images to one another, but additional work is necessary in order to ensure that we can compare two images from the same shoe (or two images from different shoes).
<details>
<p><summary> Fine Alignment of two images using RNiftyReg
</summary></p>
<p>The <code>RNiftyReg</code> package is intended for alignment of brain scans and other MRI data and uses a symmetric block-matching approach<span class="citation">(Modat et al. <a href="#ref-modatGlobalImageRegistration2014" role="doc-biblioref">2014</a>)</span>. It only allows for registration of images up to 2048x2048, though, which means we will have to align images at a lower resolution and then modify the transformation matrix accordingly. One definite positive feature is that it allows for provision of a mask for both the source and target images so that only pixels within the mask are used for alignment. <!-- This means that we could be using the original images and just providing the mask to ensure alignment --></p>
<p><em>Affine transformations</em> are a type of image transformation that encompasses translation, resizing, rotation, and skew operations. Affine transformations preserve collinearity and ratios of distances: parallel lines remain parallel after the transformation. A subset of affine transformations are so-called “rigid body” transformations, which only allow translation and rotation.</p>
<p><img src="images/shoes/longitudinal/affine_transformations.png" width = "100%"/></p>
<p>RNiftyReg allows for linear (rigid-body, affine), and nonlinear transformations, but for the moment, we are only interested in rigid-body transformations - while the shoes may have some slight distortion due to the wearer and kinematics of walking, this is minor and should not interfere too greatly with a gross alignment.</p>
<p>RNiftyReg’s <code>niftyreg.linear</code> function returns a 4x4 transformation matrix describing the composition of multiple image transformation operations. A 3x3 matrix is necessary for 3-dimensional image rotation, resizing, and skew operations; it is then augmented by a row of zeros on the bottom and a column ending with a 1 that describes the x, y, and z translation coordinates. In this way, a 4x4 matrix can represent the composition of all relevant image transformation operations in 3 dimensions. In two dimensions, many of the cells in this matrix are 0.</p>
<table>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td>13</td>
<td>14</td>
<td>15</td>
<td>16</td>
</tr>
</tbody>
</table>
<p>Cells 1, 2, 5, 6 describe the <a href="https://en.wikipedia.org/wiki/Rotation_matrix">rotation operation</a>; the angle of rotation can be recovered using trigonometry.</p>
<p>Cells 4, 8 describe the translation operation, e.g. the row (4) and column(8) offset from one matrix to another.</p>
<p>For 2D rigid transformations, these are the only cells which matter. Cells 11 and 16 are 1, and 3, 7, 9, 10, 12, 13, 14, 15 are all 0 under these constraints.</p>
<p>In order to use <code>RNiftyReg</code> for registration of the original-size images, we have to scale cells 4 and 8, but the rest of the cells remain unscaled.</p>
<p>Note that <code>EBImage</code> uses what is essentially the transposed version of the matrix used by <code>RNiftyReg</code>, reduced to elements 1, 2, 5, 6, 4, 8 in a 3 row by 2 column matrix.</p>
<table>
<tbody>
<tr class="odd">
<td>1</td>
<td>5</td>
</tr>
<tr class="even">
<td>2</td>
<td>6</td>
</tr>
<tr class="odd">
<td>4</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>Starting with a set of 6 shoes observed at 3 timepoints each, with 2 different “modes” of print capture, we can align both prints taken on the same date for each shoe.</p>
<p>The original images: (1 and 2 are taken at the same time point, 3 and 4, etc. 1-6 are the same physical shoe over time and so on)</p>
<p><img src="images/shoes/longitudinal/Alignment_Orig_files.png" width = "100%"/></p>
<p>The images are first aligned to masks, which are used to clean the images to reduce noise.</p>
<p><img src="images/shoes/longitudinal/Alignment_Mask_Img_Align.png" width = "100%"/></p>
<p>Then reduced-size versions of each image pair are aligned, producing a transformation matrix:</p>
<table>
<tbody>
<tr class="odd">
<td align="right">0.9999730</td>
<td align="right">-0.0073485</td>
<td align="right">0</td>
<td align="right"><strong>30.48815</strong></td>
</tr>
<tr class="even">
<td align="right">0.0073485</td>
<td align="right">0.9999730</td>
<td align="right">0</td>
<td align="right"><strong>-10.16105</strong></td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">1</td>
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0</td>
<td align="right">1.00000</td>
</tr>
</tbody>
</table>
<p>(this is one example)</p>
<p>The coordinates in bold have been scaled according to the size reduction, so that they can be applied to the full-size images.</p>
<p><img src="images/shoes/longitudinal/Alignment_Result.png" width = "100%"/></p>
<p>The resulting aligned images are shown above; black pixels are areas where both images agree; pink and blue pixels represent areas found in one image but not the other. Some images which have many bubbles (air between the film and backing) or which contain blurred or double prints do not align accurately; this is really not avoidable with automatic alignment solutions.</p>
<p>The alignment process itself (without any image preprocessing) is extremely fast, about 1s per image pair, and seems to be similar even when image size is increased by a factor of 16. Due to the scaling process and necessary modification of the transformation matrix, the alignments may be off by 1-5 pixels in some cases. <span class="new"><del>This might be handled by aligning a smaller subset of the image at full resolution.</del> Efforts to align sub-images produced less accurate alignments, likely due to the kinematic distortion of the sole during the walking process, resulting in situations where the local alignment estimate is not a good estimate of the global alignment. New attempts to find consensus alignment might include keypoint-based alignment methods, trying to identify the shoe border precisely to align that, and possibly use of Hough transforms to identify specific reproducible features that might serve as global keypoints.
</span></p>
</details>
<p>Given how well RNiftyReg works, the next question is whether all of the preprocessing is even necessary.</p>
<p>In the image below, the first row is alignment with the full image, the second is alignment with a binarized version of the output image (so masked + thresholded), and the third is automatically cropped around the mask which is aligned to the image using the rough-align process. The third row maintains most of the information and produces better alignments than the other rows; thus, we can conclude that it’s necessary to combine the preprocessing and rough alignment in order to get the best results from RNiftyReg.</p>
<p><img src="images/shoes/longitudinal/Combining_Prints_Consensus_Images.png" width="100%"/></p>
<details>
<p><summary> Fine Alignment of two images using FFT </summary>
Basic Process:</p>
<p><img src="images/shoes/longitudinal/FFT_Demo_Orig.png" width = "50%"/></p>
<ol style="list-style-type: decimal">
<li>Pad images so they’re the same size (Let’s say that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are the two images)</li>
</ol>
<p><img src="images/shoes/longitudinal/FFT_Demo_Pad.png" width = "25%"/></p>
<ol start="2" style="list-style-type: decimal">
<li>Downweight the edges of the images using a <a href="https://en.wikipedia.org/wiki/Hann_function">Hann function</a><br />
This is necessary because Fourier transforms assume images go on forever, so abrupt changes (e.g. edges) don’t work out that well. Computationally, the image is “wrapped” around itself to be considered “infinite”.</li>
</ol>
<p><img src="images/shoes/longitudinal/FFT_Demo_Hann.png" width = "25%"/></p>
<ul>
<li>The strength of the Hann function can be adjusted by a power argument<br />
<img src="bookdown-demo_files/figure-html/unnamed-chunk-381-1.png" width="672" /></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Use the Fast Fourier Transform on each image. Center the FFT’d images so that low frequencies are in the center (exchange top left quadrant with bottom right, and top right quadrant with bottom left). Call the FFT’d, centered images <span class="math inline">\(F(A)\)</span> and <span class="math inline">\(F(B)\)</span><br />
<img src="bookdown-demo_files/figure-html/unnamed-chunk-382-1.png" width="50%" /></li>
</ol>
<p><img src="images/shoes/longitudinal/FFT_Demo_FFT1.png" width = "50%"/></p>
<ol start="4" style="list-style-type: decimal">
<li><p>Recover the angle between the two images:<br />
In Fourier space, a rotated image produces the same signal in Fourier space, but rotated. To recover this information, we can use the <strong>magnitude</strong> of the FFT’d images as a new image. Call these images <span class="math inline">\(|F(A)|\)</span> and <span class="math inline">\(|F(B)|\)</span>. Then,</p>
<ol style="list-style-type: lower-alpha">
<li>Polar transform the image, so that a rotation of the original image is a linear shift of the transformed image (<span class="math inline">\(P(|F(A)|)\)</span> and <span class="math inline">\(P(|F(B)|)\)</span>). Apply Hann functions to the polar-transformed images.</li>
</ol></li>
</ol>
<p><img src="images/shoes/longitudinal/FFT_Demo_Hann.png" width = "25%"/></p>
<pre><code>b. Use FFT-based alignment (see steps 3, 5) to pick out the $\theta, \rho$ which best align the two polar images

c. Discard $\rho$ and keep $\theta$. Transform the original image (not the FFT&#39;d image) to get $\tilde{B}_\theta$ and recompute the FFT on the rotated image ($F(\tilde{B}_\theta)$).     </code></pre>
<p><img src="images/shoes/longitudinal/FFT_Demo_FFT3_Rotate.png" width = "50%"/></p>
<ol start="5" style="list-style-type: decimal">
<li><p>Recover the shift between the two images:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the cross-power spectrum: <span class="math inline">\(S = F(A) \times F(\tilde{B}_\theta)*\)</span>, where <span class="math inline">\(F(x)*\)</span> is the complex conjugate of <span class="math inline">\(F(x)\)</span> (e.g. <span class="math inline">\(a + bi\)</span> becomes <span class="math inline">\(a - bi\)</span>)</p></li>
<li><p>Compute the magnitude of the cross-power spectrum: <span class="math inline">\(|S| = \sqrt{S \times S*}\)</span></p></li>
<li><p>Use (a) and (b) to get the normalized cross power spectrum: <span class="math inline">\(S/|S|\)</span></p></li>
<li><p>Take the inverse FFT of <span class="math inline">\(S/|S|\)</span>: <span class="math inline">\(A = F^{-1}(S/|S|)\)</span></p></li>
<li><p>Find the maximum of the <span class="math inline">\(A\)</span> matrix. The row and column where the maximum is found are the shift to align the two images: <span class="math inline">\((\Delta x, \Delta y)\)</span>.</p></li>
</ol></li>
</ol>
<p><img src="images/shoes/longitudinal/FFT_Demo_FFT4_Shift.png" width = "25%"/></p>
<ol start="6" style="list-style-type: decimal">
<li>Apply the shift to image <span class="math inline">\(\tilde{B}_\theta\)</span> to get <span class="math inline">\(\tilde{B}_{\theta,\Delta x, \Delta y}\)</span>.</li>
</ol>
<p><img src="images/shoes/longitudinal/FFT_Demo_FFT5_Shift.png" width = "25%"/></p>
<p>There are some fiddly details (e.g. converting shifts which are most of the image into negative shifts), but FFT-based alignment works pretty well (and pretty quickly) for shoes.</p>
<p>Original Images:</p>
<p><img src="images/shoes/longitudinal/FFT_Alignment_Orig_20191031.png" width = "100%"/></p>
<p>Angle-aligned Images:</p>
<p><img src="images/shoes/longitudinal/FFT_Alignment_Angle_Only_20191031.png" width = "100%"/></p>
<p>FFT-Aligned Result: (still working out the kinks)</p>
<p><img src="images/shoes/longitudinal/FFT_Alignment_20191031.png" width = "100%"/></p>
</details>
<details>
<p><summary>Combining information from multiple images</summary></p>
<p>With aligned images, we can then combine the information in each of the two prints taken at the same timepoint to get more reliable images. Because the methodology for acquiring the prints changed from timepoint to timepoint, the analysis of each type of print doesn’t make sense - it is completely conflated with the observation date. However, the multiple prints aren’t wasted, because while each print may be missing information, the combination of both of the prints (when properly aligned) provides a much more reliable assessment of the shoe (and the wear of that shoe at the proper timepoint). There are at least 3 options to combine these images (note that white = 1, black = 0):</p>
<ul>
<li>Take the pixel-by-pixel minimum: this keeps all the noise from both images (but there’s relatively little noise in the cropped images, so that may not matter too much). If images are misaligned, this results in a “double” print (or smeared print). This method is also sensitive to the lightness of the print - a complete print would still be ignored if the “dark” part of the print was lighter than the “light” part of the second print.<br />
<img src="images/shoes/longitudinal/Combining_Prints_Consensus_min.png" width="100%"/></li>
<li>Take the pixel-by-pixel maximum: this keeps only points which appear strongly in both images (losing a lot of data but also a lot of noise in the process)<br />
<img src="images/shoes/longitudinal/Combining_Prints_Consensus_max.png" width="100%"/></li>
<li>Take the pixel-by-pixel mean: This would result in lighter regions where one image has “gaps” but would reduce noise and make it clear where there is less sure information.
<img src="images/shoes/longitudinal/Combining_Prints_Consensus_mean.png" width="100%"/></li>
</ul>
<p>Of these options, the first seems like the best, but the last provides some idea of whether the alignment was decent to begin with.</p>
<p>The alignment method seems to fail more frequently when one of the images is very light. It may be advantageous to invest more effort into adaptive histogram normalization.</p>
<p>Alignment Fails:</p>
<p><img src="images/shoes/longitudinal/020574R_20180411_5_x_1_boekhoff_pashek_kruse.png" width = "45%"/>
<img src="images/shoes/longitudinal/007961L_20180411_5_x_1_kruse_zwart_kruse.png" width = "45%"/>
<br/>
Alignment Success:</p>
<img src="images/shoes/longitudinal/074093L_20180207_5_x_1_csafe_boekhoff_boekhoff_hanrahan.png" width = "45%"/>
<img src="images/shoes/longitudinal/087354L_20180425_5_x_1_boekhoff_Kruse_kruse.png" width = "45%"/>
</details>
</div>
<div id="lss-paper-analysis-wear" class="section level5 unnumbered">
<h5>Wear Characterization</h5>
<p>Ideas:</p>
<ul>
<li>average intensity of cleaned image</li>
<li>length of border/edges detected</li>
</ul>
</div>
</div>
</div>
</div>
<div id="shoescanner" class="section level2">
<h2><span class="header-section-number">7.2</span> Shoe Scanner - Passive Shoe Recognition</h2>
<div id="nij-grant" class="section level3">
<h3><span class="header-section-number">7.2.1</span> NIJ Grant</h3>
<p>Grant scope: Build the shoe scanner, develop an automatic recognition algorithm for geometric design elements, test the scanner in locations around Ames.</p>
<div id="hardware" class="section level4">
<h4><span class="header-section-number">7.2.1.1</span> Hardware</h4>
<ul>
<li>2 molds made: Fiber cement held, modified cement is still under testing</li>
<li>Fiberglass in the ground being hydro-tested</li>
<li>Big mold - modified concrete, comes out of the mold tomorrow morning (2020-06-02)</li>
<li>Indoor ramp constructed - can hold 900 lbs safely</li>
<li>Electronics - waiting on plexiglass - proximity sensors aren’t working in daylight with reg plexiglass. New plexiglass ordered wednesday to diffuse top-light better</li>
</ul>
</div>
<div id="software" class="section level4">
<h4><span class="header-section-number">7.2.1.2</span> Software</h4>
<div id="whole-shoe-object-detection" class="section level5 new">
<h5><span class="header-section-number">7.2.1.2.1</span> Whole-Shoe Object Detection</h5>
<p><strong>Project Overview</strong></p>
<ul>
<li>Explore the use of RCNNs for whole-shoe object detection</li>
</ul>
<p>Preliminary results (using ~1000 previously classified images to train and then predict several thousand other images in a semi-supervised approach):</p>
<p><img src="images/shoes/neuralnets/prediction_1.png" alt="Model prediction" />
<img src="images/shoes/neuralnets/actual_1.png" alt="Actual annotations" /></p>
<p><img src="images/shoes/neuralnets/prediction_2.png" alt="Model Prediction" />
<img src="images/shoes/neuralnets/actual_2.png" alt="Actual annotation" /></p>
</div>
<div id="restoring-shoe-images" class="section level5 new">
<h5><span class="header-section-number">7.2.1.2.2</span> Restoring Shoe Images</h5>
<p><strong>Overview</strong></p>
<ul>
<li>Use CNNs to “upsample” manually degraded shoe images (or pairs of ideal and realistic images), restoring as much of the original pattern as possible.</li>
</ul>
<p>Proof of concept (with awful image scaling to 120x120 px… sorry)</p>
<div class="figure">
<img src="images/shoes/neuralnets/enhancement.PNG" alt="" />
<p class="caption">Low light enhancement with CNNs</p>
</div>
</div>
</div>
</div>
<div id="connor-convolutional-neural-network-for-outsole-recognition" class="section level3">
<h3><span class="header-section-number">7.2.2</span> CoNNOR: Convolutional Neural Network for Outsole Recognition</h3>
<details>
<p><strong>Project Overview</strong></p>
<ul>
<li>Label images of shoes according to geometric classification scheme</li>
<li>Use convolutional base of pretrained CNN VGG16 and train a new classifier on labeled features</li>
<li>Eventually, acquire real data passively and use CoNNOR to assess feature similarities and frequencies</li>
</ul>
<p><a href="https://lib.dr.iastate.edu/creativecomponents/264/">Link to submitted Creative Component on CoNNOR</a></p>
<p><a href="https://github.com/srvanderplas/CoNNORFSI">Github repository for paper submitted to Forensic Science International</a></p>
<p><strong>Exploring new directions:</strong></p>
<ul>
<li>Truncate convolutional base and train random forest on features
<ul>
<li>Could replace fully connected layers of neural net as classifier</li>
<li>Importance score can filter/reduce the number of features</li>
<li><em>Training the random forest requires too much memory for Bigfoot (CSAFE server), and still takes over two weeks on the HPC. We’re setting this goal aside for now, but could try subsampling the features for a random forest in the future.</em></li>
</ul></li>
<li><em>Spatial integration</em>
<ul>
<li><em>Model is currently set up to take in 256x256 pixels</em></li>
<li><em>Try taking in full shoe using a sliding window of size 256x256</em></li>
<li><em>View class predictions spatially</em></li>
</ul></li>
<li>Fully convolutional networks (FCNs)
<ul>
<li>Unsupervised segmentation to assess current classification scheme</li>
<li>Handle whole shoe image of any size (instead of only 256x256 pixel images)</li>
</ul></li>
</ul>
<p><strong>References for CNNs and FCNs</strong></p>
<p><a href="https://stats.stackexchange.com/questions/266075/patch-wise-training-and-fully-convolutional-training-in-fully-convolutional-neur">Stack Exchange post explaining patchwise training</a></p>
<p><a href="https://ieeexplore.ieee.org/abstract/document/6338939">“Learning Hierarchical Features for Scene Labeling”</a>: describes an application of multi-scale CNNs and image pyramids</p>
<p><a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.56.8646">“Pyramid methods in image processing”</a>: classic paper from 1984 explaining pyramid methods</p>
<p><a href="https://people.eecs.berkeley.edu/~jonlong/long_shelhamer_fcn.pdf">“Fully Convolutional Networks for Semantic Segmentation”</a></p>
<p><a href="https://arxiv.org/pdf/1711.08506.pdf">“W-Net: A Deep Model for Fully Unsupervised Image Segmentation”</a></p>
<div id="spatial-integration" class="section level4">
<h4><span class="header-section-number">7.2.2.1</span> Spatial integration</h4>
<p>The overhead costs of going fully convolutional are high; CNN papers are opaque, and many supervised techniques require fully labeled data for semantic segmentation (i.e., label every pixel). Moreover, complex models (for both supervised and unsupervised tequniques) are often only available in Python, and there are a large number of GitHub repositories of mixed quality and reliability. Filtering for quality, understanding code structures, and implementing them on HPC are all enormous tasks on their own.</p>
<p>In the meantime, it is much easier (relatively speaking) to use our existing framework of 256x256 square pixel images, for which we have generated thousands of labeled images and have already trained and improved domain-specific models. Currently, I have code working to automatically crop image borders, chop the image into 256x256 pixels (padding the image when appropriate) and equalize the contrast on the individual images.</p>
<p><strong>Pad the left and top of the image with a pre-specified offset, then chop the image into 256x256 pixel pieces</strong><br />
<img src="images/shoes/neuralnets/chop.PNG" width = "100%"/></p>
<p><strong>Equalize the contrast channel for each piece of the image</strong>
<img src="images/shoes/neuralnets/equalize.PNG" width = "100%"/></p>
<p><strong>Use the trained model to predict each piece of the image for each class</strong>
<img src="images/shoes/neuralnets/predict.PNG" width = "100%"/></p>
<p><strong>Repeat the above process for different cuts of the original image, and aggregate predictions</strong>
<img src="images/shoes/neuralnets/predict_rect.PNG" width = "100%"/></p>
<p><strong>Updates/In progress:</strong></p>
<ul>
<li>Presented on CoNNOR at <a href="https://www.grad-college.iastate.edu/three-minute-thesis/">ISU’s 3-Minute Thesis competition</a>
<ul>
<li>Preliminaries: 8 heats with 10-12 participants each</li>
<li>Runner up to a guy making better yogurt</li>
</ul></li>
<li>Implementing semantic segmentation model on HPC
<ul>
<li>Learning HPC structure, command line syntax, using Python in practice</li>
<li>Documentation assumes high baseline of knowledge :(</li>
</ul></li>
<li>Improving spatial integration process
<ul>
<li>Remove predictions for blank (and mostly blank) edge images</li>
<li>Smooth predictions for overlapping image pieces
<ul>
<li>geom_density2d(), stat_contour(), creating brush overlay with EBImage</li>
</ul></li>
</ul></li>
</ul>
<div class="new">
<p><strong>Shiny app demo</strong></p>
</div>
</details>
</div>
</div>
</div>
<div id="maxclique" class="section level2">
<h2><span class="header-section-number">7.3</span> Maximum Clique Matching</h2>
</div>
<div id="cocoa" class="section level2">
<h2><span class="header-section-number">7.4</span> Project Tread (formerly Cocoa Powder Citizen Science)</h2>
<p>Project Tread, modified from <a href="https://www.dundee.ac.uk/leverhulme/citizenscience/details/sole-searching.php">Leverhulme Institute’s Sole Searching</a>, is a developing CSAFE project with the goals of engaging community participation in forensic research and acquiring shoe print data that may be useful in future analyses.</p>
<p>In progress:</p>
<ul>
<li>Review <a href="https://forensicstats.org/project-tread/">procedures</a> and IRB documents written by James</li>
<li>Volunteers are testing modified procedure (below)</li>
<li>Be involved in set up of data collection site (through CSSM)</li>
<li>Develop plan for data analysis and use (to inform procedure modifications)</li>
</ul>
<div id="comparing-the-procedures" class="section level4">
<h4><span class="header-section-number">7.4.0.1</span> Comparing the procedures</h4>
<table>
<thead>
<tr class="header">
<th>Procedure</th>
<th>Leverhulme</th>
<th>CSAFE (initial)</th>
<th>CSAFE (proposed)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>‘Before’ Views</td>
<td>4 per shoe</td>
<td>5 per shoe</td>
<td>2 per shoe</td>
</tr>
<tr class="even">
<td>‘Before’ Pictures</td>
<td>1 per view</td>
<td>3 per view</td>
<td>1 per view</td>
</tr>
<tr class="odd">
<td>Total ‘before’ pics</td>
<td>4 per shoe</td>
<td>15 per shoe</td>
<td>2 per shoe</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Paper</td>
<td>Letter (larger)</td>
<td>8.5x11 or 8.5x14</td>
<td>8.5x11 or 8.5x14</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Actions</td>
<td>Run, jump, walk</td>
<td>Step, hop</td>
<td>Step, hop</td>
</tr>
<tr class="even">
<td>Replicates</td>
<td>6 per action</td>
<td>9 per action</td>
<td>3 per action</td>
</tr>
<tr class="odd">
<td>‘After’ Pictures</td>
<td>1 pic per rep.</td>
<td>3 pics per rep.</td>
<td>1 pic per rep.</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total # prints</td>
<td>18 per shoe</td>
<td>18 per shoe</td>
<td>6 per shoe</td>
</tr>
<tr class="even">
<td>Total # print images</td>
<td>18 per shoe</td>
<td>54 per shoe</td>
<td>6 per shoe</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Requested # shoes</td>
<td>Not specified</td>
<td>Both shoes</td>
<td>One, 2nd optional</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Total # images taken</td>
<td>22 or 44</td>
<td>138</td>
<td>8 or 16</td>
</tr>
</tbody>
</table>
<p><strong>Recommended procedure modifications:</strong></p>
<ul>
<li>Ask for one high-quality image of each shoe angle (‘before’) and print (‘after’), instead of three replicate images of each
<ul>
<li>If Project Tread submission website will be set up like current CSSM system (which takes community submissions for environmental images), intermediate quality control can help filter out bad images</li>
</ul></li>
<li>Only ask for one shoe, and make second shoe optional
<ul>
<li>E.g., always ask for left shoe, and make right shoe optional</li>
</ul></li>
<li>Ask for 3 replicates per shoe instead of 6-9
<ul>
<li>Longitudinal shoe study only uses 2-3 replicates per shoe</li>
</ul></li>
<li>Make written instructions clearer, close loopholes</li>
</ul>
<div class="new">
<h3 id="pilot-procedure-testing"><span class="header-section-number">7.4.0.1</span> Pilot procedure testing</h3>
<p><strong>Feedback from pilot testing:</strong></p>
<ul>
<li>Materials
<ul>
<li>Used 1/4 - 1/2 tsp of cocoa powder, not a “dime-size”"</li>
<li>Test/specify cocoa powder vs hot chocolate powder</li>
</ul></li>
<li>Procedure
<ul>
<li>Sift cocoa powder onto paper (brushing damages print)</li>
<li>More pictures of what things should look like</li>
<li>Fewer “before” pictures: bottom and side only</li>
<li>Mention won’t see oil if done correctly</li>
<li>Don’t stack completed prints until after imaging/scanning</li>
</ul></li>
<li>Analysis
<ul>
<li>Use printable scale/ruler for later alignment of images</li>
<li>QR code (like handwriting study) to identify action/replicate/meta info</li>
<li>Collect shoe demographics (brand, size, measurements of length/width)</li>
<li>Get “mask” by tracing around shoe</li>
</ul></li>
</ul>
</div>
<p><strong>A few images from pilot testing</strong></p>
<p><img src="images/shoes/ProjectTread/IMG_20191108_194133.jpg" width = "50%"/><img src="images/shoes/ProjectTread/IMG_20191108_194148.jpg" width = "50%"/></p>
<p><img src="images/shoes/ProjectTread/IMG_20191108_194603.jpg" width = "50%"/><img src="images/shoes/ProjectTread/IMG_20191108_194608.jpg" width = "50%"/></p>
<p><img src="images/shoes/ProjectTread/IMG_20191108_205037.jpg" width = "50%"/><img src="images/shoes/ProjectTread/scanned_print.PNG" width = "30%"/></p>
<p><img src="images/shoes/ProjectTread/SP2_1.PNG" width = "32%"/><img src="images/shoes/ProjectTread/SP2_2.PNG" width = "33%"/><img src="images/shoes/ProjectTread/SP2_3.PNG" width = "30%"/></p>
</div>
</div>
<div id="d-shoe-recognition" class="section level2">
<h2><span class="header-section-number">7.5</span> 3d Shoe Recognition</h2>
<p>Some background info: Shoe impressions are often left at crime scenes. In an ideal investigation, an impression left atthe scene of the crime is matched to the suspect’s shoe, placing them at the scene. However, it is not always that easy. An additional problem when dealing with shoes in the forensic discipline isshoes wear over time. When time elapses between the crime and recovery of the shoe, this processmay be more difficult: identifying marks may have worn away, or new marks may have been acquired due to additional wear. In order to understand the changes to an outsole of a shoe that may occur during the wear process, it is necessary to collect longitudinal data from across the shoe’s lifetime. These studies are needed to establish statistical models for shoe wear patterns and accumulated damage. In order to analyze data collected from these studies, it is imperative to develop a statistical pipeline to align and compare successive 3D scans over time. Manual alignment methods are time consuming, and do not scale effectively to large studies, because it is necessary to align hundreds of scans, observed at multiple time points, before any statistical analysis or modeling can be performed. To practically use longitudinal studies, the best approach is to develop statistical tools, to provide a pipeline in which to align and analyze two shoe scans.</p>
<p>The set up:</p>
<p>Ititally, the idea of the of the study was to use the data from the longitudial study in order to determine if one could predict wear, given pressure point matts and amount of steps and so on that was all part of the longitutidal data collection done previously. This idea has someone shifted. There is a large difference between the scans of the longitudial study that were conducted by hand scanning and those conducted using the turn table. The hand scan soles of the shoes have a wide variation not only on quality, but also on amount of shoe and direction of the scan. In order to simplify the inital processes and determining a pipeline for alignment, instead of the longitudinal shoe scans, the processes below are using a shoe that is scanned soly using the turn table to have some consistancy in the processing as we start to have a pipe line for at least alignment, then later using the longitudinal study add the extra information into the processing; amount of steps, weight,ect.</p>
<p>Steps:
<img src="images/shoes/3dshoes/Part1.png" width="100%"/>
<img src="images/shoes/3dshoes/Part2.png" width="100%"/></p>
<details>
<p><summary>
The shoe scans start as an stl file, however R does not work with stl files directly so they need to be transformed into a mesh object, in this specific case a triangle mesh object: </summary></p>
<p>Mesh Objects: A triangle mesh object is made up of the following parts, sufaces, polygons, faces, edges and vertices.</p>
<p><img src="images/shoes/3dshoes/describing_mesh.jpeg" width="100%"/></p>
<p>Looking at a mesh object at first:</p>
<p><img src="images/shoes/3dshoes/MeshObject.png" width="100%"/></p>
</details>
Some background:
At first we wanted to try to simplify the mesh object to just the basic shape in order have simplicity when aligning. The idea of allignment is to take the most basic features, allign them, then by adding complexity of the soul, further allign the two different shoes. The idea is that we want to take a lower detail scan of shoe, allign it, then by adding complexity we can further allign the shoes. However the problem was realized that we are using a prediction to allign rather than the shoe, which ran into some quick problems. The next “attempt” at alignment came from a package called morph. In order to use this package, we needed to transform the data from a mesh object into a plane of points. In order to do this, we greated the function <em>shoe_coord</em>. This function takes a triangle mesh object, and looks at the vertices that make up each triangle. With a specific amount of vertices specified using the specification vert, <em>shoe_coord</em>, takes these vertices and maps them onto a x,y,z coordinate plane. Then using this coordinate plane, the allignment process began.
<details>
<p><summary>
When working with coordinate systems, there was still not aligning, as each shoe was set on its own coordinate plane </summary></p>
Some attempts that have not really turned out well
- Transforming the mesh objects to points aligned by the center of mass to overlay them detecting difference.
<img src="images/shoes/3dshoes/AlignShoeTest.png" width="100%"/>
- Problems
- Isnt aligning properly as you can see
</details>
<p>Principal Component Analysis:
The basic idea of principal component analysis is to take a dataset with many variables, and simplify that dataset by turning the original variables into a smaller number of “Principal Components”. These principal components are the underlying structure in the data. Taking that data and giving a vector in directions where there is the most variance. Taking these egienvectors as the data, we can get a “flattened” version of our origianl shoe. This is done using singular decomposition: If the <span class="math inline">\(N \times p\)</span> matrix X has rank r then it has a so-called singular value decomposition as <span class="math inline">\(X_{N \times p} = U_{N\times r} D_{r \times r} V&#39;_{r\times p}\)</span> where U has orthonormal columns spanning the column space of X, V has orthonormal columns spanning the colum space of X’ and D is a diaginal matrix of singular values. For ordinary principal components, the columns of V are called the principal component directions in <span class="math inline">\(\Re^3\)</span> .</p>
<p>Once a shoe has been turned into coordinates from the verticies of a mesh object, we can use the function <em>prcomp</em> to get a transformation matrix.</p>
<details>
<p><summary>Some notes on this:</summary></p>
<ul>
<li>use vertices of 7 to decrease amount of points to match</li>
<li>if you have too few points also doesnt work</li>
<li>turn table works the best</li>
<li>Sony are the best matches (the shoes I personally have scanned)</li>
</ul>
</details>
<details>
<p><summary> Point cloud alignment </summary></p>
<ul>
<li>First looking at shoes with all vertices included:
<img src="images/shoes/3dshoes/PACwithallpoints.png" width="100%"/></li>
</ul>
<p><img src="images/shoes/3dshoes/SidePCAwithallpoints.png" width="100%"/></p>
<ul>
<li>Now the same shoe with fewer vertices included in the allignment
<img src="images/shoes/3dshoes/SonyPACside.png" width="100%"/></li>
</ul>
<p><img src="images/shoes/3dshoes/SonyPAC.png" width="100%"/></p>
<p>With these point clous alignments, the next step is to take the rotation matrix given by <em>prcomp</em> and apply it to the original mesh object since rather than comparing points that may or may not exsisit in comparison to each other shoes, as the vertices are not exactly the same on a mesh object from scan to scan of even the same shoe. <em>prcomp</em> gives a matrix that can be applied to a mesh object using a function called <em>transform3d</em></p>
<p><img src="images/shoes/3dshoes/prcompwithoutcenter.png" width="100%"/></p>
</details>
Once this was tried, it seems that the function <em>prcomp</em> isnt actually centering the data, although according to the code it should. So in order to overcome this issue when initially turning the stl file into a mesh object, a centering is performed using the barycenter of the shoe scan. In astronomy, the barycenter is the center of mass of two or more bodies that orbit one another and is the point about which the bodies orbit, since we are obviously only dealing with one object, the barycenter can be thought of as the center of mass for the shoe scan (the center of mass of a distribution of mass in space is the unique point where the weighted relative position of the distributed mass sums to zero). This puts the point (0,0,0) in the center of the shoe rather than the center being close to the 300s as before
<details>
<p><summary> Centering </summary>
<img src="images/shoes/3dshoes/centeredvsnoncentered.png" width="100%"/></p>
<p>The blue shoe is the original shoe grab, where the green shoe is now the shoe that has been centered on the center of mass. Now we can start with two shoes that at least have the same “center” point before principal component analysis is completed:</p>
<img src="images/shoes/3dshoes/Centeredshoes.png" width="100%"/>
</details>
Once the shoes themselves have been centered, then PCA can be compleated on the shoes themselves:
<details>
<p><summary> PCA after centering </summary>
<img src="images/shoes/3dshoes/AfterPCA.png" width="100%"/></p>
<p>The Green shoe is the original shoe grab centered, where the red shoe is now after PCA has been applied. Then using the PCA for both of the two scans we can get the following map of the two shoes with their given principal component rotation matrix applied:
<img src="images/shoes/3dshoes/RotatedShoes.png" width="100%"/></p>
<p>As you can see although they are on the same plane, they are not exactly allign. In order to get them aligned a matrix of 1s and -1 needs to be applied in some order, minimizing the RMSE</p>
<img src="images/shoes/3dshoes/Applingmatrixes.png" width="100%"/>
<img src="images/shoes/3dshoes/initalAlignment.png" width="100%"/>
</details>
<p>Once the PCA has done the initial alignment, then a secondary alignment needs to be done using Itterative Closest Point, to do this a landmark must be established. One cant just use the PCA, the way that the initial scans are only of the soles, which change as they wear, so we are trying to allign something that is not there anymore. The idea landmark will give a spot in the shoe that will not change, the arch or a large indent, in order to find a proposed landmark, we are attempting to use the maximum distance in z.</p>
<details>
<summary> </summary>
<img src="images/shoes/3dshoes/ICP1.png" width="100%"/>
<img src="images/shoes/3dshoes/ICP2.png" width="100%"/>
<img src="images/shoes/3dshoes/ICPzoom.png" width="100%"/>
</details>
<p><img src="images/shoes/3dshoes/ICPall1.png" width="100%"/>
<img src="images/shoes/3dshoes/ICPall2.png" width="100%"/>
<img src="images/shoes/3dshoes/ICPall3.png" width="100%"/></p>
<p>Automated Alignment:</p>
<p>In order to align the shoes through an automatized process, we need to use the following steps.</p>
<ol style="list-style-type: decimal">
<li>We begin with the two mesh objects of the same shoe at different time points, say time i and time j.Then using the barycenter, or center of mass, we center the shoes on the same x,y,z, coordinate system.</li>
</ol>
<p><img src="images/shoes/3dshoes/Centeredshoes.png" width="100%"/></p>
<ol start="2" style="list-style-type: decimal">
<li><p>After the shoes are then centered, they are transformed into a point cloud made up of the verities of the triangle mesh object.</p></li>
<li><p>Using these two coordinate systems. Principal component analysis is performed. This gives us a 3X3 rotation matrix in which to transform the original mesh object by the PCA rotation matrix.</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th></th>
<th>PC1</th>
<th>PC2</th>
<th>PC3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>0.5603136</td>
<td>-0.2618793</td>
<td>0.78579127</td>
</tr>
<tr class="even">
<td>y</td>
<td>0.3038740</td>
<td>0.9475434</td>
<td>0.09910676</td>
</tr>
<tr class="odd">
<td>z</td>
<td>0.7705253</td>
<td>-0.1832507</td>
<td>-0.61049973</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ol start="4" style="list-style-type: decimal">
<li><p>Due to the nature of PCA, the rotation matrix that we are using is not unique. Further more it often times has a negative determinate. If this happens, we need to rotate the mesh shoe object by a matrix whose diaginal is (1,1,-1). Leaving us with a positive determinate.</p></li>
<li><p>After this is done, there is no guarantee that the two shoes although sharing the same space in x,y,z where x is the length of the shoe, y the width and z the depth, will be in the same direction.</p></li>
</ol>
<p><img src="images/shoes/3dshoes/scan1and2afterPCA.png" width="100%"/></p>
<p>In order to correct for this we need to rotate the shoes by 180 degrees in x,y,z or a combination of those directions. There are 8 possibilities of those rotations:</p>
<ol style="list-style-type: decimal">
<li>rotation around the x-axis 180 degrees</li>
<li>rotation around the y-axis 180 degrees</li>
<li>rotation around the z-axis 180 degrees</li>
<li>rotation around the x-axis 180 degrees and the y-axis 180 degrees</li>
<li>rotation around the x-axis 180 degrees and the z-axis 180 degrees</li>
<li>rotation around the y-axis 180 degrees and the z-axis 180 degrees</li>
<li>rotation around the x-axis 180 degrees and the y-axis 180 degrees and the z-axis 180 degrees</li>
<li>No rotation is needed</li>
</ol>
there are only 4 unique matrices to deal with
<details>
<p><summary> Matrix Rotations </summary>
<img src="images/shoes/3dshoes/rotationmatrix.png" width="80%"/></p>
</details>
<p>In order to choose which one of these matrices, the first shoe scan in time is set as the base scan. Then each of the four matrices described above is applied to second scan. After each rotation, the distance between the first and second scan is measured. The matrix with the smallest distance is used as the rotation matrix, and is applied to the second shoe. For example, with scan 1 and scan 2, the four matrices lead to the following 4 distances: 2.153458, 9.124214, 9.117095, and 6.234845. Thus scan 2 is rotated by the matrix of the diag(1,1,1).</p>
<ol start="6" style="list-style-type: decimal">
<li>Once the shoes are initially alligned, ICP is applied with an iteration of the aligners choosing. Once ICP has been performed, the distance is again measured and recorded.</li>
</ol>
<p><img src="images/shoes/3dshoes/A1.png" width="80%"/>
<img src="images/shoes/3dshoes/A2.png" width="80%"/></p>
<p>Here the final distance is 0.9791678 cm</p>
<p>How distance is being measured:
In this process, we set the first scan as a base scan (here scan 1). This scan does not move through the process. Once this scan is set, using a K-D tree method the shoe is divided up into sections until there is only one vertex in each section. This process is done to the second shoe as well.</p>
<p><img src="images/shoes/3dshoes/KdTree.png" width="100%"/></p>
<p>K-D construction is as follows divide the points in half by a line perpendicular to one of the axes, in each tree. Then recursively construct k-d trees for the two sets of points, the two points corresponding to the verities of the triangles. Think of it as this, we first choose a shoe to be set. In this case shoe scan 1. Then for each one of the verticies of a triangle we draw a ball with radius then we start epsilon to be 0 and expand it till you hit the closest section with a specified point.</p>
<p>Each point is then pair with the closest euclidean distance corresponding point.For two vectors or two vectors (x_1,y_1,z_1) and (x_2,y_2,z_2), the euclidean distance is found by:
<span class="math display">\[ \sqrt(\sum^n_{i=1}(q_i-p_i)^2) \]</span></p>
<p>This is repeated for the set iterations, or until epsilon is deemed small enough. Each time the distance is measured, but the K-D tree sectioning remains the same through the process. This gives us N distances for the number of iterations. We return the final N iteration’s distances from each set of verities. The mean of these distances is then computed, giving us a distance metric. This is used to find the magnitude of the distance between the two shoes. This distance is consistent for each processing of two shoes (i.e. if you run scan 1 and scan 2 through this process, you will still get the same distance of 0.98. However, if you switch the positions of the shoe, making scan 2 the base you will get a different result, 2.243478)</p>
<p>Understanding the distance:</p>
<p>Once we have the distance, we want to understand where the wear is occurring, plotting the distance on the base scan of scan 1, we see the distance to scan 2 looks like the following:</p>
<p><img src="images/shoes/3dshoes/Dist1.png" width="80%"/>
<img src="images/shoes/3dshoes/Dist2.png" width="80%"/></p>
<p>Some Issues through the process:</p>
<ol style="list-style-type: decimal">
<li><p>Inconsistency of scans: As we have seen the cropping of the scan is inconsistent, i.e. where the scans were cut</p></li>
<li><p>How ICP is being measured:
It is unclear how much ICP is changing after each iteration. For example, in our scan1 vs scan 2 shoes if we take the mean distance after 1 iteration, then 2, up to 20 iterations we get the same mean. (next step is to go further out to see if it changes, or look at the distribution of distances after each iteration and not just the mean, to see if the tails are changing.)</p></li>
</ol>
</div>
<div id="shoe-outsole-matching-using-image-descriptors" class="section level2">
<h2><span class="header-section-number">7.6</span> Shoe outsole matching using image descriptors</h2>
<div id="method-1-edge-detection-and-mc-mc-comp" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Method 1: Edge detection and MC (MC-COMP)</h3>
<p>Under the revision by <em>Journal of Applied Statistics</em>,</p>
<p><img src="images/shoes/Features/signature.png" width="100%"/></p>
<p><strong>Comments by reviewers</strong></p>
<p>Compare your predictive accuracies on the <strong>number of circles (more or less than 3)</strong>.</p>
<p>In the previous matching, we found three circular regions in red. As reviewer requests, we selected the additional three more circles in blue. We tried the same set of mated and non-mated matching in training and testing set.</p>
<p><img src="images/shoes/Features/six_circles.png" width="100%"/></p>
<p>We get the average of the similarity values by the number of circles. The random forest is trained on the set of results summarised by the number of circles.</p>
<p><img src="images/shoes/Features/RFi_error_graph.png" width="100%"/></p>
<p>When there are five and six circles found in the questioned shoe, then the AUC is the largest as 0.96 in the test set.</p>
<p><img src="images/shoes/Features/ROC_RFi.png" width="100%"/></p>
</div>
<div id="method-2-surf-detection-and-mc-on-degraded-impressions" class="section level3">
<h3><span class="header-section-number">7.6.2</span> Method 2: SURF detection and MC on degraded impressions</h3>
<p>Accepted by <em>Statistical Analysis and Data Mining</em> in Feb. 2020.</p>
<p><strong>Comments by reviewers</strong></p>
<ol style="list-style-type: decimal">
<li>Generalization (Fingerprints, Photos of faces, … )</li>
<li>Other classifiers, besides the random forest.</li>
<li>Variable importance</li>
</ol>
</div>
<div id="research-1-features" class="section level3">
<h3><span class="header-section-number">7.6.3</span> Research 1: Features</h3>
<p>Previously, features such as edge, corner, SURF were extracted to match shoeprints. The goal of this project is to find other image descriptors as image features for shoe print matching.</p>
<p><strong>Image descriptors</strong></p>
<ul>
<li>SURF(Speeded Up Robust Features)- blobs</li>
<li>KAZE - blobs</li>
<li>ORB(Oriented FAST and Rotated BRIEF)- corners</li>
</ul>
<p><img src="images/shoes/Features/nike_kaze_orb_surf.png" width="100%"/></p>
<p><img src="images/shoes/Features/adidas_kaze_orb_surf.png" width="100%"/></p>
<p><strong>Image matching</strong></p>
<ul>
<li>CSAFE data - Nike size of 10.5 and Adidas size of 10 will be used to construct mated and non-mated matching</li>
<li>Features will be combination of strong 100 points of KAZE, ORB, SURF.</li>
</ul>
<p><img src="images/shoes/Features/shoe1_comb_features.png" width="100%"/></p>
</div>
<div id="matching-on-clean-and-full-images-with-several-features" class="section level3">
<h3><span class="header-section-number">7.6.4</span> Matching on clean and full images with several features</h3>
<p><img src="images/shoes/Features/ex_original_KM_KNM.jpg" width="100%"/></p>
<ul>
<li>Mates : Image (1) and (2)</li>
<li>Non-mates : Image (1) and (3), Image (2) and (3)</li>
</ul>
<p><strong>Performance evaluation using</strong></p>
<ul>
<li><strong>SURF 500</strong></li>
<li>KAZE 500</li>
<li>ORB 500</li>
<li>SURF 100 + KAZE 100 + ORB 100</li>
<li>SURF 200 + KAZE 200 + ORB 200</li>
<li>POC (Phase-only correlation)</li>
<li>FMTC (Fourier Mellon transformation correlation)</li>
</ul>
<p><strong>Example graphs of mates</strong>:</p>
<p><img src="images/shoes/Features/image_KM1.png" width="100%"/></p>
<p><strong>Example graphs of non-mates</strong>:</p>
<p><img src="images/shoes/Features/image_KNM1.png" width="100%"/></p>
<p><strong>Example matching table using SURF 500</strong>:</p>
<table>
<thead>
<tr class="header">
<th>Class</th>
<th>Clique size</th>
<th>Rotation angle</th>
<th>% Overlap</th>
<th>Median distance of OP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mates</td>
<td>18</td>
<td>2.11</td>
<td>0.5646</td>
<td>0.78</td>
</tr>
<tr class="even">
<td>Non-mates</td>
<td>9</td>
<td>6.43</td>
<td>0.1208</td>
<td>1.39</td>
</tr>
</tbody>
</table>
<p><strong>Density plots</strong>:</p>
<p><img src="images/shoes/Features/surf_density.png" width="100%"/></p>
<p><img src="images/shoes/Features/training_POC_FMTC.png" width="100%"/></p>
<p><strong>ROC curves on test comparisons</strong>:</p>
<p><img src="images/shoes/Features/ROC_surf.png" width="100%"/></p>
</div>
<div id="matching-on-degraded-and-partial-images" class="section level3">
<h3><span class="header-section-number">7.6.5</span> Matching on degraded and partial images</h3>
<p><strong>Example of degraded images</strong>:</p>
<p><img src="images/shoes/Features/deg_full_ex.jpg" width="100%"/></p>
<p><strong>Example crime-scene like images on dust from the data by Speir’s group</strong>:
<img src="images/shoes/Features/dust_CS.png" width="30%"/></p>
<p><strong>Density of mates and non-mates by features</strong>:
<img src="images/shoes/Features/den_features_10.png" width="100%"/></p>
<p><strong>ROC curves by features</strong>:
<img src="images/shoes/Features/ROC_degs.png" width="100%"/></p>
<p><strong>AUC values by features</strong>:
<img src="images/shoes/Features/AUC_deg.png" width="100%"/></p>
<p><strong>Relationship among similarities (% Overlap) by feature-types</strong></p>
<ul>
<li>Overlap feature (% overlap after the alignment) in the degradation level, 0</li>
</ul>
<p><img src="images/shoes/Features/feature_scatter.png" width="100%"/></p>
<ul>
<li>Overlap feature (% overlap after the alignment) in the degradation level, 10</li>
</ul>
<p><img src="images/shoes/Features/feature_scatter_deg10.png" width="100%"/></p>
<p><strong>Random forest training for the variable importance</strong></p>
<ul>
<li><p>Trained the RF, in the degradatino level of 0 and 10, on the class with the variables of all similarities by each feature type.</p></li>
<li><p>Degradation level 0
<img src="images/shoes/Features/varimp_deg0.png" width="100%"/></p></li>
<li><p>Degradation level 10
<img src="images/shoes/Features/varimp_deg10.png" width="100%"/></p></li>
</ul>
</div>
<div id="research-2-impact-of-weight-to-outsole-scans-from-everos-2d-scanner" class="section level3">
<h3><span class="header-section-number">7.6.6</span> Research 2: Impact of weight to outsole scans from EverOS 2D scanner</h3>
<p><strong>Analysis setup</strong>:</p>
<ul>
<li>Shoes: 5 pairs of Nike Winflow 4, size 10.5 (Brand-new shoes)</li>
<li>Participants: Person 1 (weight aa lb)and person 2 (bb lb)</li>
<li>Weights: 2 weight vests (20 lbs and 12 lbs)</li>
<li>Weight variations: W1(P1), W2(P1 with one vest), W3(P1 with two vests), W4(P2), W5(P2 with one vest), W6(P2 with two vests)</li>
<li>W1 <span class="math inline">\(=\)</span> 155.2 lb, <strong>W2 <span class="math inline">\(=\)</span> 173.8 lb</strong>, W3 <span class="math inline">\(=\)</span> 187.6 lb, <strong>W4 <span class="math inline">\(=\)</span> 178 lb</strong>, W5 <span class="math inline">\(=\)</span> 197.4 lb, W6 <span class="math inline">\(=\)</span> 211 lb</li>
</ul>
<p><strong>Result1</strong>:</p>
<ul>
<li>Shoe is fixed to left side of shoe1.</li>
</ul>
<p><img src="images/shoes/Features/density_person_effect.png" width="100%"/></p>
<p><strong>Result2</strong>:</p>
<ul>
<li>Purple, green: comparison between repeated replicates from the same shoe, W2-W2, W4-W4.</li>
<li>Comparison between weights W2 and W4: weights are almost the same.</li>
<li>Yellow: comparison when shoe is fixed to shoe1-L.</li>
<li>Red: comparison between shoe1 – shoe2-5.</li>
<li>Shoes are never used.</li>
</ul>
<p><img src="images/shoes/Features/density_w2_w4.png" width="100%"/></p>
<p><strong>Discrimination among groups</strong></p>
<p>Let’s simplify the question; <strong>Is the person effect significant?</strong></p>
<p><img src="images/shoes/Features/vest-w2w4.png" width="100%"/></p>
<ul>
<li>Initial analysis
<ul>
<li>Cluster analysis; hcluter</li>
<li>Principal component analysis (PCA)</li>
</ul></li>
<li>Are groups significantly different?
<ul>
<li>Multivariate Analysis of Variance (MANOVA)</li>
<li>Multi-Response Permutation Procedurs(MRPP)</li>
<li>Analysis of Group Similarities (ANOSIM)</li>
</ul></li>
<li>How do groups differ?
<ul>
<li>Discriminant Analysis (DA)</li>
<li>Classification and Regression Trees (CART)</li>
<li>Logistic Regression (LR)</li>
</ul></li>
</ul>
</div>
<div id="research-3-mc-cnn" class="section level3">
<h3><span class="header-section-number">7.6.7</span> Research 3: MC + CNN</h3>
<p><strong>Idea</strong>:</p>
<ol style="list-style-type: decimal">
<li>Align two images using MC.</li>
<li>Calculate similarity features.</li>
<li>Ask CNN to learn similarity features.</li>
<li>Combine 3 and 4. Use ResNet-50 to get a final similarity value.</li>
</ol>
<p>### Additional features from descriptors</p>
<p>Much of the outsole matching already done at CSAFE is based primarily on the geometric locations of SURF features. While this is apparently useful, the utility of SURF and other computer vision features (such as BRISK, ORB, and KAZE) can go far beyond location. Most of the work done has also been on images produced using the EverOS 2D scanner. Location features from these images are relatively easy to align, but with different image types -such as those made using fingerprint powder- alignment becomes much more difficult.</p>
<p>When a SURF (or other feature type) is detected in an image, several features are extracted. Each SURF is a detected “blob” from an image. Features from a SURF include Sign of Laplacian, orientation, location, metric, and a 1x64 vector of descriptors. Essentially these several features describe characteristics of the blob like color intensity, change in intensity, change in pattern, blob direction, etc.</p>
<p>Between two different images if two SURFs have a matching sign of Laplacian, the distance between the two 1x64 descriptor vectors is measured. If the distance is below a specified threshold the two SURFs are considered matching.</p>
<p><strong>Sign of Laplacian</strong></p>
<p><img src="images/shoes/additionalFeatures/signoflaplacian.png" width="50%"/></p>
<p><strong>64 descriptors</strong>
<img src="images/shoes/additionalFeatures/descriptorexample.png" alt="The 64 SURF descriptors come from sums of wavelet responses from 16 subsections of each SURF" /></p>
<p>When SURFs are matched, a matrix is returned with indices of matching SURFs and the measured distance. Matched features are illustrated here.</p>
<p><img src="images/shoes/additionalFeatures/powd_mate_images.jpg" width="100%"/></p>
<p><img src="images/shoes/additionalFeatures/init_SURF_match.jpg" width="100%"/></p>
<p>Clearly many of these “matched” SURFs -based on metric- are not actually corresponding parts between images. To make more precise which SURFs match, I use the maximum clique from the shoeprintr packages to align the SURF points based on location. Once aligned, Euclidean distance is used to find the closest point(s) in image 2 to each point in image 1. Now there are two sets of matching indices. The index pairs which overlap between the two sets are considered certain matches.</p>
<p><img src="images/shoes/additionalFeatures/match_plot.png" width="100%"/></p>
<p><img src="images/shoes/additionalFeatures/certain_SURF_match.png" width="100%"/></p>
<p>The number of “certain” matching SURFs and the metric between SURF descriptors can be used as two additional features for image pair comparison.</p>
<p><strong>Useable features</strong></p>
<ul>
<li>Clique Size</li>
<li>Rotation Angle</li>
<li>% Overlap</li>
<li>Median distance of OP</li>
<li><strong>Certain SURF matches</strong></li>
<li><strong>Max SURF match corr</strong></li>
</ul>
<p>We’ve trained 2 different random forests using these features from image pairs.</p>
<p>The first random forest uses 115 pairs of images using matching soles with the same stepping style and 116 pair of images of the same shoes with different stepping style. The random forest classification accuracy using leave one out cross validation is 92%</p>
<p><strong>Different step type average variable values</strong></p>
<table>
<colgroup>
<col width="5%" />
<col width="11%" />
<col width="14%" />
<col width="9%" />
<col width="19%" />
<col width="19%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th>Class</th>
<th>Clique size</th>
<th>Rotation angle</th>
<th>% Overlap</th>
<th>Median distance of OP</th>
<th>Certain SURF matches</th>
<th>Max SURF match corr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Same steps</td>
<td>8</td>
<td>3.97</td>
<td>0.1992</td>
<td>1.21</td>
<td>13</td>
<td>0.9523</td>
</tr>
<tr class="even">
<td>Dif steps</td>
<td>6</td>
<td>14.04</td>
<td>0.0169</td>
<td>0.99</td>
<td>0.487</td>
<td>0.2236</td>
</tr>
</tbody>
</table>
<p><strong><em>RF Variable importance</em></strong></p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Importance Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Certain SURF matches</td>
<td>100.000</td>
</tr>
<tr class="even">
<td>% Overlap</td>
<td>14.951</td>
</tr>
<tr class="odd">
<td>Max SURF match corr</td>
<td>14.059</td>
</tr>
<tr class="even">
<td>Rotation angle</td>
<td>4.484</td>
</tr>
<tr class="odd">
<td>Median distance of OP</td>
<td>2.359</td>
</tr>
<tr class="even">
<td>Clique size</td>
<td>0.000</td>
</tr>
</tbody>
</table>
<p>The second rf is trained from 115 images of matching shoes with the same stepping style and 116 images of non-matching shoes with the same stepping style. The random forest classification accuracy was also 92%</p>
<p><strong>Match v. non-match average variable values</strong></p>
<table>
<colgroup>
<col width="5%" />
<col width="11%" />
<col width="14%" />
<col width="9%" />
<col width="19%" />
<col width="19%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th>Class</th>
<th>Clique size</th>
<th>Rotation angle</th>
<th>% Overlap</th>
<th>Median distance of OP</th>
<th>Certain SURF matches</th>
<th>Max SURF match corr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mates</td>
<td>8</td>
<td>3.97</td>
<td>0.1992</td>
<td>1.21</td>
<td>13</td>
<td>0.9523</td>
</tr>
<tr class="even">
<td>Non-mates</td>
<td>6</td>
<td>9.26</td>
<td>0.0164</td>
<td>1.24</td>
<td>0.836</td>
<td>0.2821</td>
</tr>
</tbody>
</table>
<p><strong>RF Variable importance</strong></p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Importance Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>% Overlap</td>
<td>100.000</td>
</tr>
<tr class="even">
<td>Certain SURF matches</td>
<td>34.044</td>
</tr>
<tr class="odd">
<td>Max SURF match corr</td>
<td>26.937</td>
</tr>
<tr class="even">
<td>Rotation angle</td>
<td>2.221</td>
</tr>
<tr class="odd">
<td>Median distance of OP</td>
<td>2.213</td>
</tr>
<tr class="even">
<td>Clique size</td>
<td>0.000</td>
</tr>
</tbody>
</table>
<p><strong>Improvements to be made</strong></p>
<p>When two images using fingerprint powder are are from the same shoe and with the same stepping style, the alignment using maximum clique is generally good. However, when the sole images are not mates the alignment is occasionally not good. The alignment is especially poor when the step style changes.</p>
<p><img src="images/shoes/additionalFeatures/match_dif_step_im.jpg" width="100%"/></p>
<p><img src="images/shoes/additionalFeatures/dif_step_plot.png" width="100%"/></p>
<p>So far, other existing methods haven’t shown any more effectiveness in aligning shoes than the maximum clique. It would be useful if features could be made from the SURF descriptors which could be used to compare shoes without needing to align the images.</p>
</div>
</div>
<div id="matching-shoe-prints-with-ccf" class="section level2">
<h2><span class="header-section-number">7.7</span> Matching shoe prints with ccf</h2>
<div id="steps-to-match-two-shoe-scans" class="section level4">
<h4><span class="header-section-number">7.7.0.1</span> Steps to match two shoe scans</h4>
<pre><code>## Warning: package &#39;imager&#39; was built under R version 4.0.2</code></pre>
<ol style="list-style-type: decimal">
<li>Training/Test sets</li>
</ol>
<ul>
<li><p>Training set: Shoe scans from 10 shoes that have size 7 and were scanned twice at visit1. Then, 10 matching pairs and 90 non-matching pairs are made. e.g., a matching pair is scan1 and scan2 from the same shoes; a non-matching pair is scan1 from one shoe and scan1 from another shoe.</p></li>
<li><p>Test set: Shoe scans from 10 shoes that have size 7.5 and were scanned twice at visit1. Then, 10 matching pairs and 90 non-matching pairs are made.</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Align each matching/non-matching pair in training and test sets using Matlab. For each pair, one is reference image and the other is moving image to be aligned with the reference image. For example,</li>
</ol>
<ul>
<li>Ex1: A matching pair: scan1 (left; reference) and scan2 (right; moving) from shoe1</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-384-1.png" width="672" /></p>
<ul>
<li>Ex2: A non-matching pair: scan1 (left; reference) from shoe2 and scan1 (right; moving) from shoe1</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
<ul>
<li>Ex3: A non-matching pair: scan1 (left; reference) from shoe3 and scan1 (right; moving) from shoe1</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-386-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Determine 600px by 600px square coordinate for all of the reference images; the location of square is the same for each reference image. For example, the bottom left corner is at (601, 1001) and the top right corner is at (1200, 1600).</li>
</ol>
<ul>
<li>Ex1: A matching pair: scan1 (left; reference) and scan2 (right; moving) from shoe1</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
<ul>
<li>Ex2: A non-matching pair: scan1 (left; reference) from shoe2 and scan1 (right; moving) from shoe1</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-388-1.png" width="672" /></p>
<ul>
<li>Ex3: A non-matching pair: scan1 (left; reference) from shoe3 and scan1 (right; moving) from shoe1</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Extract the 600px by 600px square from both reference and moving images in each matching/non-matching pair, and then split each square into 36 smaller squares that are 100px by 100px. As a result, there are 36 100px by 100px squares are obtained from the reference and moving images, respectively, in each pair.</li>
</ol>
<ul>
<li>Ex1:</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-390-1.png" width="672" /></p>
<ul>
<li>Ex2:</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
<ul>
<li>Ex3:</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-392-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Compute maximum cross correlation function from a small square of a reference image and its corresponding small square of the moving image. Consequently, there are 36 maximum ccf and their (dx, dy) obtained from each matching/nonmatching pair. Summarize ccf, dx, and dy so that only a single set of features from them is made from each pair.</li>
</ol>
<pre><code>##   fft_ccf_mean fft_ccf_sd fft_ccf_range      x_mean       x_sd x_range
## 1    0.9828075 0.01881824     0.1086021  -1.0277778  0.1666667       1
## 2    0.6441020 0.31670677     0.9436405 -14.7500000 21.3426133      49
## 3    0.9227980 0.03798925     0.1634415  -4.6666667  3.5375536      10
## 4    0.9433072 0.04561463     0.1955301  -1.1388889  0.6825489       3
## 5    0.9209677 0.07129483     0.2674146  -0.9166667  0.6035609       2
## 6    0.9009049 0.06332662     0.2651907  -2.5277778  3.2025535      16
##        y_mean       y_sd y_range moving.Img.no fixed.Img.no actual.matching
## 1  -0.9444444  0.2323107       1             1            1               1
## 2 -14.5833333 21.4933545      49             1            2               0
## 3  -1.0277778  0.7362496       5             1            3               0
## 4  -0.4722222  0.9996031       4             1            4               0
## 5  -0.5277778  0.8778581       4             1            5               0
## 6  -2.9722222  4.2794266      19             1            6               0</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Train randomforest based on the features of ccf, dx, and dy from the training set, and predict whether each pair in the test set is matching or non-matching.</li>
</ol>
<pre><code>## Warning: package &#39;randomForest&#39; was built under R version 4.0.2</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
</div>
<div id="massive-matching-pairs-added-to-training-set" class="section level4">
<h4><span class="header-section-number">7.7.0.2</span> Massive matching pairs added to training set</h4>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-396-1.png" width="672" /></p>
</div>
<div id="hanas-update-on-215" class="section level4">
<h4><span class="header-section-number">7.7.0.3</span> Hana’s update on 2/15</h4>
<ul>
<li>Evaluated the performance of matching using ccf with and without maximum clique method. Unfortunately, the ccf features were not helpful to increase the accuracy of maximum clique method.</li>
</ul>
</div>
<div id="hanas-update-on-222" class="section level4">
<h4><span class="header-section-number">7.7.0.4</span> Hana’s update on 2/22</h4>
<ul>
<li>Worked on the algorithm to extract circular features from echo shoes. It was processed mostly well, but there is much room to develop like removing non-circle features automatically, and not missing circular features.</li>
</ul>
</div>
<div id="hanas-update-on-31" class="section level4">
<h4><span class="header-section-number">7.7.0.5</span> Hana’s update on 3/1</h4>
<ul>
<li><p>Evaluated the performance of matching using ccf with and without maximum clique method based on degraded scans because maximum clique’s performance has been poor on degraded images. One thing to note was that aligning degraded shoe scans were not processed well eveon in Matlab. For example, two scans from the same shoe at a degraded level were not aligned properly sometimes. Two scans from the same shoe at two different levels were unlikely to be aligned.</p></li>
<li><p>We still want to see the potential of CCF method, so plan to align degraded scans manually and then to apply CCF method to improve the matching performance of maximum clique method with CCF features added.</p></li>
</ul>
</div>
<div id="hanas-update-on-37" class="section level4">
<h4><span class="header-section-number">7.7.0.6</span> Hana’s update on 3/7</h4>
<ul>
<li><p>Not much for shoes</p></li>
<li><p>Compared the performance of likelihood ratio based on forensic hypotheses to that of optimal matching rule through simulation study where normal populations were assumed. Likelihood ratios, ROC curve, and prediction accuracy (overall accuracy, sensitivity, and specificiy) at the optimal thresholds were fairly close but there was subtle difference. We wanted to distingush optimal matching rule from forensic likelihood ratio method as well as classification discriminant. This simulation result will be discussed with Dr.Ommen soon once I finalize this simulation.</p></li>
</ul>
<p>####Round Robin Updates</p>
<p><em>February 8th,2020 Matias Ibarburu</em>
I finished creating data sets for Nike shoes. I created 6 dataframes, one for each shoe image and visit comparison. These are better than my prior Nike data frames because they only compare shoes of the same size. These data frames also have the advantage that each shoe size has the same proportion in each data frame, and is the same proportion that each size appears in the longitudinal study. The matched comparisons and the non-matched comparisons have equal representation in each dataset.</p>
<p><em>February 15th 2020, Matias Ibarburu</em>
I am in the process of analyzing and writing up the datasets I have created for Nike.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-modatGlobalImageRegistration2014">
<p>Modat, Marc, David M. Cash, Pankaj Daga, Gavin P. Winston, John S. Duncan, and Sébastien Ourselin. 2014. “Global Image Registration Using a Symmetric Block-Matching Approach.” <em>Journal of Medical Imaging (Bellingham, Wash.)</em> 1 (2). <a href="https://doi.org/10.1117/1.JMI.1.2.024003">https://doi.org/10.1117/1.JMI.1.2.024003</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glass.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="theoretical-foundations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-shoes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
